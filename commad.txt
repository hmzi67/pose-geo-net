python tarin.py --variant dual_branch --backbone efficientnet_b0 --epochs 150


Epoch 110/150 | Train MAE: 1.9347Â° | Val MAE: 1.1923Â° (Yaw=1.3364Â°, Pitch=1.1781Â°, Roll=1.0624Â°)
Epoch 115/150 | Train MAE: 1.9464Â° | Val MAE: 1.2628Â° (Yaw=1.4546Â°, Pitch=1.2593Â°, Roll=1.0746Â°)
Epoch 120/150 | Train MAE: 1.9007Â° | Val MAE: 1.2514Â° (Yaw=1.5966Â°, Pitch=1.1714Â°, Roll=0.9861Â°)
Epoch 125/150 | Train MAE: 1.8768Â° | Val MAE: 1.1640Â° (Yaw=1.4270Â°, Pitch=1.1336Â°, Roll=0.9316Â°)
Epoch 130/150 | Train MAE: 1.8707Â° | Val MAE: 1.1305Â° (Yaw=1.4008Â°, Pitch=1.0221Â°, Roll=0.9687Â°)
Epoch 135/150 | Train MAE: 1.8470Â° | Val MAE: 1.1339Â° (Yaw=1.2685Â°, Pitch=1.1317Â°, Roll=1.0014Â°)
Epoch 140/150 | Train MAE: 1.8360Â° | Val MAE: 1.1997Â° (Yaw=1.4078Â°, Pitch=1.2097Â°, Roll=0.9817Â°)
Epoch 145/150 | Train MAE: 1.8120Â° | Val MAE: 1.2112Â° (Yaw=1.4413Â°, Pitch=1.2276Â°, Roll=0.9649Â°)
Epoch 150/150 | Train MAE: 1.7863Â° | Val MAE: 1.1003Â° (Yaw=1.2402Â°, Pitch=1.1483Â°, Roll=0.9125Â°)

======================================================================
âœ… TRAINING COMPLETE!
======================================================================

ğŸ“Š Results:
   Best Val MAE:     1.0853Â°
   Final Epoch:      150
   Model saved to:   models/ablation/architecture/dual_branch_efficientnet_b0_best.pth
   Parameters:       8,041,407

âœ… Architecture variant 'dual_branch' training complete!
   Best validation MAE: 1.0853Â°
(venv) âœ  Archive git:(main) âœ— 
(venv) âœ  Archive git:(main) âœ— 
(venv) âœ  Archive git:(main) âœ— 





Epoch 140/150 | Train MAE: 1.8314Â° | Val MAE: 1.1665Â° (Yaw=1.3604Â°, Pitch=1.1264Â°, Roll=1.0127Â°)
Epoch 145/150 | Train MAE: 1.8234Â° | Val MAE: 1.2525Â° (Yaw=1.3871Â°, Pitch=1.2675Â°, Roll=1.1028Â°)
Epoch 150/150 | Train MAE: 1.8026Â° | Val MAE: 1.0926Â° (Yaw=1.2546Â°, Pitch=1.1008Â°, Roll=0.9222Â°)

======================================================================
âœ… TRAINING COMPLETE!
======================================================================

ğŸ“Š Results:
   Best Val MAE:     1.0800Â°
   Final Epoch:      150
   Model saved to:   models/ablation/architecture/dual_branch_efficientnet_b0_best.pth
   Parameters:       7,910,591

âœ… Architecture variant 'dual_branch' training complete!
   Best validation MAE: 1.0800Â°
(venv) âœ  Archive git:(main) âœ— 


Epoch 115/150 | Train MAE: 1.9080Â° | Val MAE: 1.2180Â° (Yaw=1.3893Â°, Pitch=1.1819Â°, Roll=1.0828Â°)
Epoch 120/150 | Train MAE: 1.9035Â° | Val MAE: 1.2682Â° (Yaw=1.4183Â°, Pitch=1.3590Â°, Roll=1.0273Â°)
Epoch 125/150 | Train MAE: 1.9110Â° | Val MAE: 1.1573Â° (Yaw=1.4131Â°, Pitch=1.0796Â°, Roll=0.9791Â°)

Early stopping triggered after 126 epochs (no improvement for 20 epochs)

======================================================================
âœ… TRAINING COMPLETE!
======================================================================

ğŸ“Š Results:
   Best Val MAE:     1.1207Â°
   Final Epoch:      126
   Model saved to:   models/ablation/architecture/dual_branch_efficientnet_b0_best.pth
   Parameters:       9,279,231

âœ… Architecture variant 'dual_branch' training complete!
   Best validation MAE: 1.1207Â°
(venv) âœ  Archive git:(main) âœ— 



Epoch 115/150 | Train MAE: 1.9195Â° | Val MAE: 1.1668Â° (Yaw=1.3378Â°, Pitch=1.2032Â°, Roll=0.9593Â°)
Epoch 120/150 | Train MAE: 1.8945Â° | Val MAE: 1.3009Â° (Yaw=1.5470Â°, Pitch=1.3171Â°, Roll=1.0386Â°)
Epoch 125/150 | Train MAE: 1.8801Â° | Val MAE: 1.1501Â° (Yaw=1.2732Â°, Pitch=1.2121Â°, Roll=0.9650Â°)
Epoch 130/150 | Train MAE: 1.8759Â° | Val MAE: 1.1716Â° (Yaw=1.3644Â°, Pitch=1.1472Â°, Roll=1.0034Â°)
Epoch 135/150 | Train MAE: 1.9080Â° | Val MAE: 1.9869Â° (Yaw=2.6453Â°, Pitch=1.9300Â°, Roll=1.3853Â°)
Epoch 140/150 | Train MAE: 1.8063Â° | Val MAE: 1.1261Â° (Yaw=1.2693Â°, Pitch=1.0981Â°, Roll=1.0110Â°)
   âœ“ New best model saved (Val MAE: 1.1261Â°)
Epoch 145/150 | Train MAE: 1.7872Â° | Val MAE: 1.0951Â° (Yaw=1.2631Â°, Pitch=1.0099Â°, Roll=1.0124Â°)
Epoch 150/150 | Train MAE: 1.8005Â° | Val MAE: 1.1456Â° (Yaw=1.3751Â°, Pitch=1.0953Â°, Roll=0.9665Â°)

======================================================================
âœ… TRAINING COMPLETE!
======================================================================

ğŸ“Š Results:
   Best Val MAE:     1.0451Â°
   Final Epoch:      150
   Model saved to:   models/ablation/architecture/dual_branch_efficientnet_b0_best.pth
   Parameters:       8,467,742

âœ… Architecture variant 'dual_branch' training complete!
   Best validation MAE: 1.0451Â°
(venv) âœ  Archive git:(main) âœ— 






poch  70/150 | Train MAE: 2.2269Â° | Val MAE: 1.5041Â° (Yaw=1.6415Â°, Pitch=1.6997Â°, Roll=1.1710Â°)
Epoch  75/150 | Train MAE: 2.1920Â° | Val MAE: 1.3801Â° (Yaw=1.5743Â°, Pitch=1.3567Â°, Roll=1.2094Â°)
Epoch  80/150 | Train MAE: 2.1734Â° | Val MAE: 1.2866Â° (Yaw=1.5224Â°, Pitch=1.2600Â°, Roll=1.0772Â°)
Epoch  85/150 | Train MAE: 2.0972Â° | Val MAE: 1.3373Â° (Yaw=1.4594Â°, Pitch=1.5441Â°, Roll=1.0083Â°)
Epoch  90/150 | Train MAE: 2.0560Â° | Val MAE: 1.3061Â° (Yaw=1.5155Â°, Pitch=1.3387Â°, Roll=1.0640Â°)
Epoch  95/150 | Train MAE: 2.0379Â° | Val MAE: 1.3159Â° (Yaw=1.5704Â°, Pitch=1.3067Â°, Roll=1.0705Â°)
Epoch 100/150 | Train MAE: 2.0013Â° | Val MAE: 1.2571Â° (Yaw=1.4144Â°, Pitch=1.3188Â°, Roll=1.0382Â°)
Epoch 105/150 | Train MAE: 1.9613Â° | Val MAE: 1.2482Â° (Yaw=1.5578Â°, Pitch=1.1785Â°, Roll=1.0081Â°)
Epoch 110/150 | Train MAE: 1.9413Â° | Val MAE: 1.1978Â° (Yaw=1.3979Â°, Pitch=1.2058Â°, Roll=0.9899Â°)
Epoch 115/150 | Train MAE: 1.9250Â° | Val MAE: 1.1759Â° (Yaw=1.2910Â°, Pitch=1.2601Â°, Roll=0.9766Â°)
Epoch 120/150 | Train MAE: 1.8829Â° | Val MAE: 1.2168Â° (Yaw=1.4669Â°, Pitch=1.2054Â°, Roll=0.9783Â°)
Epoch 125/150 | Train MAE: 1.8750Â° | Val MAE: 1.1976Â° (Yaw=1.2585Â°, Pitch=1.3240Â°, Roll=1.0103Â°)
Epoch 130/150 | Train MAE: 1.8857Â° | Val MAE: 1.1293Â° (Yaw=1.3358Â°, Pitch=1.0948Â°, Roll=0.9573Â°)
Epoch 135/150 | Train MAE: 1.8399Â° | Val MAE: 1.1384Â° (Yaw=1.2606Â°, Pitch=1.1961Â°, Roll=0.9584Â°)
Epoch 140/150 | Train MAE: 1.8242Â° | Val MAE: 1.1422Â° (Yaw=1.4582Â°, Pitch=1.0419Â°, Roll=0.9264Â°)
Epoch 145/150 | Train MAE: 1.8231Â° | Val MAE: 1.0940Â° (Yaw=1.2973Â°, Pitch=1.0883Â°, Roll=0.8963Â°)
Epoch 150/150 | Train MAE: 1.7636Â° | Val MAE: 1.1330Â° (Yaw=1.2454Â°, Pitch=1.1379Â°, Roll=1.0157Â°)

======================================================================
âœ… TRAINING COMPLETE!
======================================================================

ğŸ“Š Results:
   Best Val MAE:     1.0677Â°
   Final Epoch:      150
   Model saved to:   models/ablation/architecture/dual_branch_efficientnet_b0_best.pth
   Parameters:       7,910,591

âœ… Architecture variant 'dual_branch' training complete!
   Best validation MAE: 1.0677Â°
(venv) âœ  Archive git:(main) âœ— 
(venv) âœ  Archive git:(main) âœ— 







chmod +x /home/genesys/hamza/cervical/Archive/run_fusion_ablation.sh



cd /home/genesys/hamza/cervical/Archive && source venv/bin/activate && python train_fusion_ablation.py --fusion_type early --backbone efficientnet_b0 --epochs 150 --batch_size 64 --patience 20




   Average FPS: 8.8
(venv) âœ  Archive git:(main) âœ— python live_inference.py
  File "/home/genesys/hamza/cervical/Archive/live_inference.py", line 233
    for face_idx, (x, y, w, h) in enumerate(faces):
    ^
IndentationError: expected an indented block after 'for' statement on line 231
(venv) âœ  Archive git:(main) âœ— 




python train_fusion_ablation.py \
    --fusion_type attention \
    --backbone efficientnet_b0 \
    --face_dim 1404 \
    --pose_dim 99 \
    --epochs 150

    (venv) âœ  Archive git:(main) âœ— python train_fusion_ablation.py \
    --fusion_type attention \
    --backbone efficientnet_b0 \
    --face_dim 1404 \
    --pose_dim 99 \
    --epochs 150
usage: train_fusion_ablation.py [-h] --fusion_type
                                {early,attention,bilinear,late}
                                [--backbone {resnet18,resnet34,resnet50,mobilenet_v3_large,efficientnet_b0}]
                                [--epochs EPOCHS] [--batch_size BATCH_SIZE]
                                [--patience PATIENCE] [--output_dir OUTPUT_DIR]
                                [--eval_only]
train_fusion_ablation.py: error: unrecognized arguments: --face_dim 1404 --pose_dim 99
(venv) âœ  Archive git:(main) âœ— 


160Â° | Val MAE: 1.3205Â° (Yaw=1.6350Â°, Pitch=1.2867Â°, Roll=1.0398Â°)    
Epoch  70/150 | Train MAE: 1.8869Â° | Val MAE: 1.1780Â° (Yaw=1.3536Â°, Pitch=1.1920Â°, Roll=0.9883Â°)    
   âœ“ New best model saved (Val MAE: 1.1780Â°)
Epoch  75/150 | Train MAE: 1.8324Â° | Val MAE: 1.2004Â° (Yaw=1.4583Â°, Pitch=1.1439Â°, Roll=0.9990Â°)    
Epoch  80/150 | Train MAE: 1.8118Â° | Val MAE: 1.2197Â° (Yaw=1.4656Â°, Pitch=1.1716Â°, Roll=1.0219Â°)    
Epoch  85/150 | Train MAE: 1.7945Â° | Val MAE: 1.1677Â° (Yaw=1.3600Â°, Pitch=1.1390Â°, Roll=1.0040Â°)    
Epoch  90/150 | Train MAE: 1.7751Â° | Val MAE: 1.1866Â° (Yaw=1.4760Â°, Pitch=1.0957Â°, Roll=0.9882Â°)    
Epoch  95/150 | Train MAE: 1.7612Â° | Val MAE: 1.0613Â° (Yaw=1.2179Â°, Pitch=1.0735Â°, Roll=0.8926Â°)    
Epoch 100/150 | Train MAE: 1.7273Â° | Val MAE: 1.1086Â° (Yaw=1.3966Â°, Pitch=1.0084Â°, Roll=0.9208Â°)    
Epoch 105/150 | Train MAE: 1.7230Â° | Val MAE: 1.0965Â° (Yaw=1.3310Â°, Pitch=1.0170Â°, Roll=0.9416Â°)    
Epoch 110/150 | Train MAE: 1.7126Â° | Val MAE: 1.0806Â° (Yaw=1.2188Â°, Pitch=1.0770Â°, Roll=0.9460Â°)    
Epoch 115/150 | Train MAE: 1.6950Â° | Val MAE: 1.1218Â° (Yaw=1.2726Â°, Pitch=1.1081Â°, Roll=0.9846Â°)    
Epoch 120/150 | Train MAE: 1.6798Â° | Val MAE: 1.1126Â° (Yaw=1.3395Â°, Pitch=1.1055Â°, Roll=0.8930Â°)    
Epoch 125/150 | Train MAE: 1.6686Â° | Val MAE: 1.0481Â° (Yaw=1.2407Â°, Pitch=0.9501Â°, Roll=0.9534Â°)    
Epoch 130/150 | Train MAE: 1.6522Â° | Val MAE: 1.0865Â° (Yaw=1.2570Â°, Pitch=1.0708Â°, Roll=0.9317Â°)    
Epoch 135/150 | Train MAE: 1.6128Â° | Val MAE: 1.0174Â° (Yaw=1.1803Â°, Pitch=0.9788Â°, Roll=0.8930Â°)    
Epoch 140/150 | Train MAE: 1.6310Â° | Val MAE: 1.0669Â° (Yaw=1.2332Â°, Pitch=1.0569Â°, Roll=0.9105Â°)    
Epoch 145/150 | Train MAE: 1.6267Â° | Val MAE: 1.0605Â° (Yaw=1.3142Â°, Pitch=0.9659Â°, Roll=0.9012Â°)    
                                                                                                    
Early stopping triggered after 147 epochs (no improvement for 20 epochs)

======================================================================
âœ… TRAINING COMPLETE!
======================================================================

ğŸ“Š Results:
   Best Val MAE:     1.0032Â°
   Yaw MAE:          1.1335Â°
   Pitch MAE:        1.0034Â°
   Roll MAE:         0.8727Â°
   Final Epoch:      147
   Model saved to:   models/ablation/fusion/fusion_attention_efficientnet_b0_best.pth
   History saved to: models/ablation/fusion/fusion_attention_efficientnet_b0_history.csv
   Parameters:       6,127,262

âœ… Fusion variant 'attention' training complete!
   Best validation MAE: 1.0032Â°



python train_fusion_ablation.py \
    --fusion_type attention \
    --backbone efficientnet_b0 \
    --face_dim 1404 \
    --pose_dim 99 \
    --epochs 150



rain MAE: 2.1814Â° | Val MAE: 1.3831Â° (Yaw=1.7691Â°, Pitch=1.3335Â°, Roll=1.0467Â°)    
Epoch  50/150 | Train MAE: 2.1359Â° | Val MAE: 1.2775Â° (Yaw=1.4919Â°, Pitch=1.3213Â°, Roll=1.0193Â°)    
   âœ“ New best model saved (Val MAE: 1.2775Â°)
Epoch  55/150 | Train MAE: 2.0966Â° | Val MAE: 1.3064Â° (Yaw=1.6314Â°, Pitch=1.2565Â°, Roll=1.0312Â°)    
Epoch  60/150 | Train MAE: 2.0434Â° | Val MAE: 1.2964Â° (Yaw=1.5757Â°, Pitch=1.2723Â°, Roll=1.0411Â°)    
Epoch 63/150:  21%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–                                     | 39/184 [00:11<00:35,  4.04it/s]Epoch  65/150 | Train MAE: 2.0117Â° | Val MAE: 1.4101Â° (Yaw=1.8317Â°, Pitch=1.3192Â°, Roll=1.0796Â°)    
Epoch  70/150 | Train MAE: 1.9788Â° | Val MAE: 1.3116Â° (Yaw=1.6840Â°, Pitch=1.1941Â°, Roll=1.0567Â°)    
Epoch  75/150 | Train MAE: 1.9445Â° | Val MAE: 1.1892Â° (Yaw=1.3579Â°, Pitch=1.1932Â°, Roll=1.0166Â°)    
Epoch  80/150 | Train MAE: 1.9259Â° | Val MAE: 1.2522Â° (Yaw=1.4573Â°, Pitch=1.2167Â°, Roll=1.0825Â°)    
Epoch  85/150 | Train MAE: 1.9247Â° | Val MAE: 1.1310Â° (Yaw=1.3682Â°, Pitch=1.1106Â°, Roll=0.9143Â°)    
Epoch  90/150 | Train MAE: 1.9907Â° | Val MAE: 1.3455Â° (Yaw=1.5254Â°, Pitch=1.4417Â°, Roll=1.0694Â°)    
Epoch  95/150 | Train MAE: 1.8419Â° | Val MAE: 1.0785Â° (Yaw=1.2118Â°, Pitch=1.1197Â°, Roll=0.9040Â°)    
Epoch 100/150 | Train MAE: 1.9219Â° | Val MAE: 1.1880Â° (Yaw=1.4320Â°, Pitch=1.1170Â°, Roll=1.0151Â°)    
Epoch 105/150 | Train MAE: 1.7681Â° | Val MAE: 1.0947Â° (Yaw=1.3292Â°, Pitch=1.0069Â°, Roll=0.9479Â°)    
Epoch 110/150 | Train MAE: 1.7658Â° | Val MAE: 1.1952Â° (Yaw=1.3983Â°, Pitch=1.2094Â°, Roll=0.9780Â°)    
                                                                                                    
Early stopping triggered after 114 epochs (no improvement for 20 epochs)

======================================================================
âœ… TRAINING COMPLETE!
======================================================================

ğŸ“Š Results:
   Best Val MAE:     1.0516Â°
   Yaw MAE:          1.2218Â°
   Pitch MAE:        1.0439Â°
   Roll MAE:         0.8890Â°
   Final Epoch:      114
   Model saved to:   models/ablation/fusion/fusion_attention_efficientnet_b0_best.pth
   History saved to: models/ablation/fusion/fusion_attention_efficientnet_b0_history.csv
   Parameters:       7,866,782





======================================================================
ğŸ“Š EVALUATING ATTENTION FUSION ON TEST SET
======================================================================
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=None`.
  warnings.warn(msg)
Traceback (most recent call last):
  File "/home/genesys/hamza/cervical/Archive/train_fusion_ablation.py", line 557, in <module>
    main()
  File "/home/genesys/hamza/cervical/Archive/train_fusion_ablation.py", line 549, in main
    test_metrics = evaluate_on_test(args)
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/genesys/hamza/cervical/Archive/train_fusion_ablation.py", line 386, in evaluate_on_test
    model.load_state_dict(checkpoint['model_state'])
  File "/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 2629, in load_state_dict
    raise RuntimeError(
RuntimeError: Error(s) in loading state_dict for AttentionFusionModel:
        size mismatch for face_head.4.weight: copying a param with shape torch.Size([1404, 768]) from checkpoint, the shape in current model is torch.Size([256, 768]).
        size mismatch for face_head.4.bias: copying a param with shape torch.Size([1404]) from checkpoint, the shape in current model is torch.Size([256]).
        size mismatch for face_head.6.weight: copying a param with shape torch.Size([1404]) from checkpoint, the shape in current model is torch.Size([256]).
        size mismatch for face_head.6.bias: copying a param with shape torch.Size([1404]) from checkpoint, the shape in current model is torch.Size([256]).
        size mismatch for face_head.6.running_mean: copying a param with shape torch.Size([1404]) from checkpoint, the shape in current model is torch.Size([256]).
        size mismatch for face_head.6.running_var: copying a param with shape torch.Size([1404]) from checkpoint, the shape in current model is torch.Size([256]).
        size mismatch for pose_head.4.weight: copying a param with shape torch.Size([99, 256]) from checkpoint, the shape in current model is torch.Size([64, 256]).
        size mismatch for pose_head.4.bias: copying a param with shape torch.Size([99]) from checkpoint, the shape in current model is torch.Size([64]).
        size mismatch for pose_head.6.weight: copying a param with shape torch.Size([99]) from checkpoint, the shape in current model is torch.Size([64]).
        size mismatch for pose_head.6.bias: copying a param with shape torch.Size([99]) from checkpoint, the shape in current model is torch.Size([64]).
        size mismatch for pose_head.6.running_mean: copying a param with shape torch.Size([99]) from checkpoint, the shape in current model is torch.Size([64]).
        size mismatch for pose_head.6.running_var: copying a param with shape torch.Size([99]) from checkpoint, the shape in current model is torch.Size([64]).
        size mismatch for attention.0.weight: copying a param with shape torch.Size([128, 1503]) from checkpoint, the shape in current model is torch.Size([128, 320]).
        size mismatch for regression_head.0.weight: copying a param with shape torch.Size([128, 1503]) from checkpoint, the shape in current model is torch.Size([128, 320]).
(venv) âœ  Archive git:(main) âœ—  


 python train_fusion_ablation.py --fusion_type late --backbone efficientnet_b0 --face_dim 1404 --pose_dim 99 --epochs 150

 Setting up training...

ğŸš€ Starting training...
======================================================================
Epoch   1/150 | Train MAE: 13.2983Â° | Val MAE: 7.7594Â° (Yaw=12.0673Â°, Pitch=6.2092Â°, Roll=5.0015Â°)  
Epoch   5/150 | Train MAE: 5.0553Â° | Val MAE: 2.9874Â° (Yaw=3.9337Â°, Pitch=2.6356Â°, Roll=2.3929Â°)    
Epoch  10/150 | Train MAE: 4.0338Â° | Val MAE: 2.4321Â° (Yaw=3.2209Â°, Pitch=2.2112Â°, Roll=1.8642Â°)    
Epoch  15/150 | Train MAE: 3.5947Â° | Val MAE: 2.0513Â° (Yaw=2.3594Â°, Pitch=2.0825Â°, Roll=1.7118Â°)    
Epoch  20/150 | Train MAE: 3.3380Â° | Val MAE: 1.8531Â° (Yaw=2.1756Â°, Pitch=1.8350Â°, Roll=1.5487Â°)    
Epoch  25/150 | Train MAE: 3.1381Â° | Val MAE: 1.9252Â° (Yaw=2.1755Â°, Pitch=1.9606Â°, Roll=1.6395Â°)    
Epoch  30/150 | Train MAE: 2.9324Â° | Val MAE: 1.7583Â° (Yaw=2.0884Â°, Pitch=1.7951Â°, Roll=1.3913Â°)    
Epoch  35/150 | Train MAE: 2.8123Â° | Val MAE: 1.9216Â° (Yaw=2.0603Â°, Pitch=2.1096Â°, Roll=1.5948Â°)    
Epoch  40/150 | Train MAE: 2.7340Â° | Val MAE: 1.7375Â° (Yaw=1.9520Â°, Pitch=1.8648Â°, Roll=1.3957Â°)    
Epoch 45/150:   0%|                                                         | 0/184 [00:00<?, ?it/s]


python train_fusion_ablation.py --fusion_type late --backbone efficientnet_b0 --face_dim 1404 --pose_dim 99 --eval_only



python train_fusion_ablation.py --fusion_type early --backbone efficientnet_b0 --face_dim 1404 --pose_dim 99 --epochs 150



rchive git:(main) âœ— source /home/genesys/hamza/cervical/Archive/venv/bin/activate
(venv) âœ  Archive git:(main) âœ— python train_fusion_ablation.py \                            
    --fusion_type late \     
    --backbone efficientnet_b0 \
    --face_dim 1404 \
    --pose_dim 99 \
    --eval_only

======================================================================
ğŸ“Š EVALUATING LATE FUSION ON TEST SET
======================================================================
âŒ Model not found: models/ablation/fusion/fusion_late_efficientnet_b0_best.pth
(venv) âœ  Archive git:(main) âœ—  python train_fusion_ablation.py --fusion_type late --backbone efficientnet_b0 --face_dim 1404 --pose_dim 99 --epochs 150
======================================================================
ğŸ”— FUSION STRATEGY ABLATION: LATE
======================================================================

ğŸ“‹ Configuration:
   Fusion Type: late
   Backbone:    efficientnet_b0
   Face Dim:    1404
   Pose Dim:    99
   Epochs:      150
   Batch size:  64
   Output dir:  models/ablation/fusion
   Device:      cuda

ğŸ” Checking data preprocessing...
âœ… Data preprocessing already complete - skipping
   Using splits from: data/splits

ğŸ“‚ Loading data splits...
   Train samples: 11758
   Val samples:   784
   Y mean: [  8.20929   -10.902234   -1.4025756]
   Y std:  [30.444633 24.493015 11.616344]

ğŸ—ï¸  Creating model...
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=EfficientNet_B0_Weights.IMAGENET1K_V1`. You can also use `weights=EfficientNet_B0_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
   Fusion Type:  late
   Backbone:     efficientnet_b0
   Parameters:   8,467,742
   Model size:   32.30 MB

âš™ï¸  Setting up training...

ğŸš€ Starting training...
======================================================================
Epoch   1/150 | Train MAE: 13.2983Â° | Val MAE: 7.7594Â° (Yaw=12.0673Â°, Pitch=6.2092Â°, Roll=5.0015Â°)  
Epoch   5/150 | Train MAE: 5.0553Â° | Val MAE: 2.9874Â° (Yaw=3.9337Â°, Pitch=2.6356Â°, Roll=2.3929Â°)    
Epoch  10/150 | Train MAE: 4.0338Â° | Val MAE: 2.4321Â° (Yaw=3.2209Â°, Pitch=2.2112Â°, Roll=1.8642Â°)    
Epoch  15/150 | Train MAE: 3.5947Â° | Val MAE: 2.0513Â° (Yaw=2.3594Â°, Pitch=2.0825Â°, Roll=1.7118Â°)    
Epoch  20/150 | Train MAE: 3.3380Â° | Val MAE: 1.8531Â° (Yaw=2.1756Â°, Pitch=1.8350Â°, Roll=1.5487Â°)    
Epoch  25/150 | Train MAE: 3.1381Â° | Val MAE: 1.9252Â° (Yaw=2.1755Â°, Pitch=1.9606Â°, Roll=1.6395Â°)    
Epoch  30/150 | Train MAE: 2.9324Â° | Val MAE: 1.7583Â° (Yaw=2.0884Â°, Pitch=1.7951Â°, Roll=1.3913Â°)    
Epoch  35/150 | Train MAE: 2.8123Â° | Val MAE: 1.9216Â° (Yaw=2.0603Â°, Pitch=2.1096Â°, Roll=1.5948Â°)    
Epoch  40/150 | Train MAE: 2.7340Â° | Val MAE: 1.7375Â° (Yaw=1.9520Â°, Pitch=1.8648Â°, Roll=1.3957Â°)    
Epoch  45/150 | Train MAE: 2.6373Â° | Val MAE: 1.6155Â° (Yaw=1.8891Â°, Pitch=1.7681Â°, Roll=1.1893Â°)    
Epoch  50/150 | Train MAE: 2.5014Â° | Val MAE: 1.4520Â° (Yaw=1.7245Â°, Pitch=1.3755Â°, Roll=1.2561Â°)    
   âœ“ New best model saved (Val MAE: 1.4520Â°)
Epoch  55/150 | Train MAE: 2.4155Â° | Val MAE: 1.4843Â° (Yaw=1.6744Â°, Pitch=1.5934Â°, Roll=1.1851Â°)    
Epoch  60/150 | Train MAE: 2.3330Â° | Val MAE: 1.5084Â° (Yaw=1.7300Â°, Pitch=1.5297Â°, Roll=1.2657Â°)    
Epoch  65/150 | Train MAE: 2.2980Â° | Val MAE: 1.4712Â° (Yaw=1.5997Â°, Pitch=1.6166Â°, Roll=1.1972Â°)    
Epoch  70/150 | Train MAE: 2.2709Â° | Val MAE: 1.4147Â° (Yaw=1.4037Â°, Pitch=1.7346Â°, Roll=1.1057Â°)    
Epoch  75/150 | Train MAE: 2.1783Â° | Val MAE: 1.2674Â° (Yaw=1.5492Â°, Pitch=1.2615Â°, Roll=0.9914Â°)    
Epoch  80/150 | Train MAE: 2.1575Â° | Val MAE: 1.3952Â° (Yaw=1.5847Â°, Pitch=1.4516Â°, Roll=1.1492Â°)    
Epoch  85/150 | Train MAE: 2.0966Â° | Val MAE: 1.2587Â° (Yaw=1.4298Â°, Pitch=1.3407Â°, Roll=1.0058Â°)    
Epoch  90/150 | Train MAE: 2.0444Â° | Val MAE: 1.2522Â° (Yaw=1.4031Â°, Pitch=1.2999Â°, Roll=1.0536Â°)    
Epoch  95/150 | Train MAE: 2.0253Â° | Val MAE: 1.2350Â° (Yaw=1.3834Â°, Pitch=1.2571Â°, Roll=1.0644Â°)    
Epoch 100/150 | Train MAE: 2.0297Â° | Val MAE: 1.1748Â° (Yaw=1.4752Â°, Pitch=1.0974Â°, Roll=0.9516Â°)    
Epoch 105/150 | Train MAE: 1.9792Â° | Val MAE: 1.2672Â° (Yaw=1.6247Â°, Pitch=1.1529Â°, Roll=1.0240Â°)    
Epoch 110/150 | Train MAE: 1.9265Â° | Val MAE: 1.2363Â° (Yaw=1.4823Â°, Pitch=1.1731Â°, Roll=1.0534Â°)    
Epoch 115/150 | Train MAE: 1.9356Â° | Val MAE: 1.2121Â° (Yaw=1.3309Â°, Pitch=1.1969Â°, Roll=1.1086Â°)    
Epoch 120/150 | Train MAE: 1.9169Â° | Val MAE: 1.1839Â° (Yaw=1.3310Â°, Pitch=1.2351Â°, Roll=0.9856Â°)    
Epoch 125/150 | Train MAE: 1.8918Â° | Val MAE: 1.1226Â° (Yaw=1.1950Â°, Pitch=1.1871Â°, Roll=0.9857Â°)    
Epoch 130/150 | Train MAE: 1.8838Â° | Val MAE: 1.1235Â° (Yaw=1.3132Â°, Pitch=1.0896Â°, Roll=0.9678Â°)    
Epoch 135/150 | Train MAE: 1.8525Â° | Val MAE: 1.1552Â° (Yaw=1.3933Â°, Pitch=1.0659Â°, Roll=1.0064Â°)    
Epoch 140/150 | Train MAE: 1.8091Â° | Val MAE: 1.1187Â° (Yaw=1.2934Â°, Pitch=1.1270Â°, Roll=0.9357Â°)    
Epoch 145/150 | Train MAE: 1.8104Â° | Val MAE: 1.1164Â° (Yaw=1.3446Â°, Pitch=1.0777Â°, Roll=0.9270Â°)    
Epoch 150/150 | Train MAE: 1.8165Â° | Val MAE: 1.1094Â° (Yaw=1.2481Â°, Pitch=1.1226Â°, Roll=0.9573Â°)    

======================================================================
âœ… TRAINING COMPLETE!
======================================================================

ğŸ“Š Results:
   Best Val MAE:     1.0732Â°
   Yaw MAE:          1.2487Â°
   Pitch MAE:        1.0468Â°
   Roll MAE:         0.9241Â°
   Final Epoch:      150
   Model saved to:   models/ablation/fusion/fusion_late_efficientnet_b0_best.pth
   History saved to: models/ablation/fusion/fusion_late_efficientnet_b0_history.csv
   Parameters:       8,467,742

âœ… Fusion variant 'late' training complete!
   Best validation MAE: 1.0732Â°

======================================================================
ğŸ“Š EVALUATING LATE FUSION ON TEST SET
======================================================================
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=None`.
  warnings.warn(msg)
   Test samples: 3136
Testing: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 49/49 [00:11<00:00,  4.27it/s]

ğŸ“ˆ Test Results:
   Yaw MAE:   1.1881Â°
   Pitch MAE: 1.0144Â°
   Roll MAE:  0.9674Â°
   Mean MAE:  1.0566Â°

   Results saved to: results/csv_reports/fusion_late_test_results.csv

âœ… Test evaluation complete!
   Test MAE: 1.0566Â°
(venv) âœ  Archive git:(main) âœ— python train_fusion_ablation.py --fusion_type late --backbone efficientnet_b0 --face_dim 1404 --pose_dim 99 --eval_only

======================================================================
ğŸ“Š EVALUATING LATE FUSION ON TEST SET
======================================================================
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=None`.
  warnings.warn(msg)
   Test samples: 3136
Testing: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 49/49 [00:13<00:00,  3.56it/s]

ğŸ“ˆ Test Results:
   Yaw MAE:   1.1881Â°
   Pitch MAE: 1.0144Â°
   Roll MAE:  0.9674Â°
   Mean MAE:  1.0566Â°

   Results saved to: results/csv_reports/fusion_late_test_results.csv

âœ… Test evaluation complete!
   Test MAE: 1.0566Â°
(venv) âœ  Archive git:(main) âœ— python train_fusion_ablation.py --fusion_type early --backbone efficientnet_b0 --face_dim 1404 --pose_dim 99 --epochs 150
======================================================================
ğŸ”— FUSION STRATEGY ABLATION: EARLY
======================================================================

ğŸ“‹ Configuration:
   Fusion Type: early
   Backbone:    efficientnet_b0
   Face Dim:    1404
   Pose Dim:    99
   Epochs:      150
   Batch size:  64
   Output dir:  models/ablation/fusion
   Device:      cuda

ğŸ” Checking data preprocessing...
âœ… Data preprocessing already complete - skipping
   Using splits from: data/splits

ğŸ“‚ Loading data splits...
   Train samples: 11758
   Val samples:   784
   Y mean: [  8.20929   -10.902234   -1.4025756]
   Y std:  [30.444633 24.493015 11.616344]

ğŸ—ï¸  Creating model...
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=EfficientNet_B0_Weights.IMAGENET1K_V1`. You can also use `weights=EfficientNet_B0_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
   Fusion Type:  early
   Backbone:     efficientnet_b0
   Parameters:   4,829,567
   Model size:   18.42 MB

âš™ï¸  Setting up training...

ğŸš€ Starting training...
======================================================================
Epoch   1/150 | Train MAE: 12.5757Â° | Val MAE: 6.9477Â° (Yaw=11.6138Â°, Pitch=5.0830Â°, Roll=4.1463Â°)
Epoch   5/150 | Train MAE: 4.8527Â° | Val MAE: 2.6957Â° (Yaw=3.3097Â°, Pitch=2.4954Â°, Roll=2.2821Â°)
Epoch  10/150 | Train MAE: 4.0344Â° | Val MAE: 2.1094Â° (Yaw=2.5436Â°, Pitch=2.0598Â°, Roll=1.7248Â°)
   âœ“ New best model saved (Val MAE: 2.1094Â°)
Epoch  15/150 | Train MAE: 3.6151Â° | Val MAE: 1.8645Â° (Yaw=2.3781Â°, Pitch=1.6800Â°, Roll=1.5354Â°)
Epoch  20/150 | Train MAE: 3.2680Â° | Val MAE: 1.8031Â° (Yaw=2.0599Â°, Pitch=1.9535Â°, Roll=1.3960Â°)
Epoch  25/150 | Train MAE: 3.0692Â° | Val MAE: 1.5834Â° (Yaw=1.8808Â°, Pitch=1.4968Â°, Roll=1.3725Â°)
Epoch  30/150 | Train MAE: 2.9637Â° | Val MAE: 1.4961Â° (Yaw=1.8286Â°, Pitch=1.4078Â°, Roll=1.2520Â°)
   âœ“ New best model saved (Val MAE: 1.4961Â°)
Epoch  35/150 | Train MAE: 2.8928Â° | Val MAE: 1.5787Â° (Yaw=1.9642Â°, Pitch=1.5216Â°, Roll=1.2502Â°)
Epoch  40/150 | Train MAE: 2.7949Â° | Val MAE: 1.6235Â° (Yaw=2.0003Â°, Pitch=1.6175Â°, Roll=1.2526Â°)
Epoch  45/150 | Train MAE: 2.6644Â° | Val MAE: 1.4359Â° (Yaw=1.6863Â°, Pitch=1.4013Â°, Roll=1.2200Â°)
Epoch  50/150 | Train MAE: 2.5904Â° | Val MAE: 1.3408Â° (Yaw=1.5192Â°, Pitch=1.3489Â°, Roll=1.1542Â°)
   âœ“ New best model saved (Val MAE: 1.3408Â°)
Epoch  55/150 | Train MAE: 2.5428Â° | Val MAE: 1.3148Â° (Yaw=1.4906Â°, Pitch=1.3765Â°, Roll=1.0774Â°)
Epoch  60/150 | Train MAE: 2.4514Â° | Val MAE: 1.3250Â° (Yaw=1.5621Â°, Pitch=1.3610Â°, Roll=1.0520Â°)       
Epoch  65/150 | Train MAE: 2.4440Â° | Val MAE: 1.2827Â° (Yaw=1.5420Â°, Pitch=1.2666Â°, Roll=1.0393Â°)       
Epoch  70/150 | Train MAE: 2.3805Â° | Val MAE: 1.2829Â° (Yaw=1.5706Â°, Pitch=1.2936Â°, Roll=0.9845Â°)       
Epoch  75/150 | Train MAE: 2.3250Â° | Val MAE: 1.1795Â° (Yaw=1.3994Â°, Pitch=1.1447Â°, Roll=0.9942Â°)       
Epoch  80/150 | Train MAE: 2.2796Â° | Val MAE: 1.1999Â° (Yaw=1.4398Â°, Pitch=1.0765Â°, Roll=1.0833Â°)       
Epoch  85/150 | Train MAE: 2.2767Â° | Val MAE: 1.2678Â° (Yaw=1.5157Â°, Pitch=1.2140Â°, Roll=1.0736Â°)       
Epoch  90/150 | Train MAE: 2.2359Â° | Val MAE: 1.2083Â° (Yaw=1.3779Â°, Pitch=1.2328Â°, Roll=1.0142Â°)       
Epoch  95/150 | Train MAE: 2.2168Â° | Val MAE: 1.1513Â° (Yaw=1.2309Â°, Pitch=1.2268Â°, Roll=0.9961Â°)       
Epoch 100/150 | Train MAE: 2.2062Â° | Val MAE: 1.1987Â° (Yaw=1.3915Â°, Pitch=1.1823Â°, Roll=1.0224Â°)       
Epoch 105/150 | Train MAE: 2.1625Â° | Val MAE: 1.2510Â° (Yaw=1.5506Â°, Pitch=1.2018Â°, Roll=1.0006Â°)       
Epoch 110/150 | Train MAE: 2.1600Â° | Val MAE: 1.2150Â° (Yaw=1.4681Â°, Pitch=1.1668Â°, Roll=1.0101Â°)       
Epoch 115/150 | Train MAE: 2.0970Â° | Val MAE: 1.1428Â° (Yaw=1.4290Â°, Pitch=1.0719Â°, Roll=0.9275Â°)       
                                                                                                       
Early stopping triggered after 116 epochs (no improvement for 20 epochs)

======================================================================
âœ… TRAINING COMPLETE!
======================================================================

ğŸ“Š Results:
   Best Val MAE:     1.1014Â°
   Yaw MAE:          1.3123Â°
   Pitch MAE:        1.0381Â°
   Roll MAE:         0.9538Â°
   Final Epoch:      116
   Model saved to:   models/ablation/fusion/fusion_early_efficientnet_b0_best.pth
   History saved to: models/ablation/fusion/fusion_early_efficientnet_b0_history.csv
   Parameters:       4,829,567

âœ… Fusion variant 'early' training complete!
   Best validation MAE: 1.1014Â°

======================================================================
ğŸ“Š EVALUATING EARLY FUSION ON TEST SET
======================================================================
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=None`.
  warnings.warn(msg)
   Test samples: 3136
Testing: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 49/49 [00:11<00:00,  4.32it/s]

ğŸ“ˆ Test Results:
   Yaw MAE:   1.2902Â°
   Pitch MAE: 1.0620Â°
   Roll MAE:  1.0126Â°
   Mean MAE:  1.1216Â°

   Results saved to: results/csv_reports/fusion_early_test_results.csv

âœ… Test evaluation complete!
   Test MAE: 1.1216Â°
(venv) âœ  Archive git:(main) âœ— python train_fusion_ablation.py --fusion_type bilinear --backbone efficientnet_b0 --face_dim 1404 --pose_dim 99 --epochs 150
======================================================================
ğŸ”— FUSION STRATEGY ABLATION: BILINEAR
======================================================================

ğŸ“‹ Configuration:
   Fusion Type: bilinear
   Backbone:    efficientnet_b0
   Face Dim:    1404
   Pose Dim:    99
   Epochs:      150
   Batch size:  64
   Output dir:  models/ablation/fusion
   Device:      cuda

ğŸ” Checking data preprocessing...
âœ… Data preprocessing already complete - skipping
   Using splits from: data/splits

ğŸ“‚ Loading data splits...
   Train samples: 11758
   Val samples:   784
   Y mean: [  8.20929   -10.902234   -1.4025756]
   Y std:  [30.444633 24.493015 11.616344]

ğŸ—ï¸  Creating model...
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=EfficientNet_B0_Weights.IMAGENET1K_V1`. You can also use `weights=EfficientNet_B0_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
   Fusion Type:  bilinear
   Backbone:     efficientnet_b0
   Parameters:   5,079,135
   Model size:   19.38 MB

âš™ï¸  Setting up training...

ğŸš€ Starting training...
======================================================================
Epoch   1/150 | Train MAE: 17.4652Â° | Val MAE: 17.7055Â° (Yaw=24.7769Â°, Pitch=20.0241Â°, Roll=8.3153Â°)   
Epoch   5/150 | Train MAE: 17.4728Â° | Val MAE: 17.6499Â° (Yaw=24.6039Â°, Pitch=19.9884Â°, Roll=8.3574Â°)   
Epoch  10/150 | Train MAE: 17.4486Â° | Val MAE: 17.6784Â° (Yaw=24.6925Â°, Pitch=19.9721Â°, Roll=8.3705Â°)   
Epoch  15/150 | Train MAE: 17.4165Â° | Val MAE: 17.6943Â° (Yaw=24.6582Â°, Pitch=20.0432Â°, Roll=8.3816Â°)   
Epoch  20/150 | Train MAE: 17.4558Â° | Val MAE: 17.6630Â° (Yaw=24.7205Â°, Pitch=19.9231Â°, Roll=8.3454Â°)   
Epoch  25/150 | Train MAE: 17.4633Â° | Val MAE: 17.6207Â° (Yaw=24.6767Â°, Pitch=19.8360Â°, Roll=8.3494Â°)   
                                                                                                       
Early stopping triggered after 26 epochs (no improvement for 20 epochs)

======================================================================
âœ… TRAINING COMPLETE!
======================================================================

ğŸ“Š Results:
   Best Val MAE:     17.5972Â°
   Yaw MAE:          24.5484Â°
   Pitch MAE:        19.9283Â°
   Roll MAE:         8.3150Â°
   Final Epoch:      26
   Model saved to:   models/ablation/fusion/fusion_bilinear_efficientnet_b0_best.pth
   History saved to: models/ablation/fusion/fusion_bilinear_efficientnet_b0_history.csv
   Parameters:       5,079,135

âœ… Fusion variant 'bilinear' training complete!
   Best validation MAE: 17.5972Â°

======================================================================
ğŸ“Š EVALUATING BILINEAR FUSION ON TEST SET
======================================================================
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=None`.
  warnings.warn(msg)
   Test samples: 3136
Testing: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 49/49 [00:11<00:00,  4.27it/s]

ğŸ“ˆ Test Results:
   Yaw MAE:   24.6087Â°
   Pitch MAE: 19.3653Â°
   Roll MAE:  7.8199Â°
   Mean MAE:  17.2646Â°

   Results saved to: results/csv_reports/fusion_bilinear_test_results.csv

âœ… Test evaluation complete!
   Test MAE: 17.2646Â°
(venv) âœ  Archive git:(main) âœ— python train_fusion_ablation.py --fusion_type early --backbone efficientnet_b0 --face_dim 1404 --pose_dim 99 --epochs 150




# 512:128
python train_fusion_ablation.py --fusion_type attention --backbone efficientnet_b0 --face_dim 512 --pose_dim 128 --epochs 150 --dim_ablation

# 1024:256
python train_fusion_ablation.py --fusion_type attention --backbone efficientnet_b0 --face_dim 1024 --pose_dim 256 --epochs 150 --dim_ablation

# 768:768
python train_fusion_ablation.py --fusion_type attention --backbone efficientnet_b0 --face_dim 768 --pose_dim 768 --epochs 150 --dim_ablation

# 2048:64
python train_fusion_ablation.py --fusion_type attention --backbone efficientnet_b0 --face_dim 2048 --pose_dim 64 --epochs 150 --dim_ablation

# 1404:99 (yours)
python train_fusion_ablation.py --fusion_type attention --backbone efficientnet_b0 --face_dim 1404 --pose_dim 99 --epochs 150 --dim_ablation








âœ  Archive git:(main) âœ— source /home/genesys/hamza/cervical/Archive/venv/bin/activate
(venv) âœ  Archive git:(main) âœ— ./run_dimension_attention_ablation.sh 
======================================================================
ğŸš€ DIMENSION ABLATION (ATTENTION FUSION) - Starting all experiments
======================================================================

======================================================================
[1/5] Training attention fusion with dims 512:128
======================================================================
======================================================================
ğŸ”— FUSION STRATEGY ABLATION: ATTENTION
======================================================================

ğŸ“‹ Configuration:
   Fusion Type: attention
   Backbone:    efficientnet_b0
   Face Dim:    512
   Pose Dim:    128
   Epochs:      150
   Batch size:  64
   Output dir:  models/ablation/dimension_attention
   Device:      cuda

ğŸ” Checking data preprocessing...
âœ… Data preprocessing already complete - skipping
   Using splits from: data/splits

ğŸ“‚ Loading data splits...
   Train samples: 11758
   Val samples:   784
   Y mean: [  8.20929   -10.902234   -1.4025756]
   Y std:  [30.444633 24.493015 11.616344]

ğŸ—ï¸  Creating model...
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=EfficientNet_B0_Weights.IMAGENET1K_V1`. You can also use `weights=EfficientNet_B0_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
   Fusion Type:  attention
   Backbone:     efficientnet_b0
   Parameters:   6,965,633
   Model size:   26.57 MB

âš™ï¸  Setting up training...

ğŸš€ Starting training...
======================================================================
Epoch   1/150 | Train MAE: 11.0973Â° | Val MAE: 5.2140Â° (Yaw=7.5906Â°, Pitch=4.3554Â°, Roll=3.6960Â°)      
Epoch   5/150 | Train MAE: 3.9377Â° | Val MAE: 2.9257Â° (Yaw=3.7637Â°, Pitch=2.7566Â°, Roll=2.2569Â°)       
Epoch  10/150 | Train MAE: 3.2111Â° | Val MAE: 2.0310Â° (Yaw=2.4222Â°, Pitch=2.0110Â°, Roll=1.6597Â°)       
Epoch  15/150 | Train MAE: 3.0021Â° | Val MAE: 1.7000Â° (Yaw=2.0860Â°, Pitch=1.6155Â°, Roll=1.3984Â°)       
Epoch  20/150 | Train MAE: 2.7309Â° | Val MAE: 1.6508Â° (Yaw=1.9966Â°, Pitch=1.6065Â°, Roll=1.3492Â°)       
Epoch  25/150 | Train MAE: 2.5760Â° | Val MAE: 1.4967Â° (Yaw=1.7142Â°, Pitch=1.4616Â°, Roll=1.3143Â°)       
Epoch  30/150 | Train MAE: 2.4251Â° | Val MAE: 1.5080Â° (Yaw=1.7753Â°, Pitch=1.4687Â°, Roll=1.2799Â°)       
Epoch  35/150 | Train MAE: 2.3160Â° | Val MAE: 1.4095Â° (Yaw=1.6269Â°, Pitch=1.3954Â°, Roll=1.2062Â°)       
Epoch  40/150 | Train MAE: 2.2411Â° | Val MAE: 1.3601Â° (Yaw=1.5342Â°, Pitch=1.3869Â°, Roll=1.1592Â°)       
   âœ“ New best model saved (Val MAE: 1.3601Â°)
Epoch  45/150 | Train MAE: 2.1444Â° | Val MAE: 1.5092Â° (Yaw=1.9397Â°, Pitch=1.4432Â°, Roll=1.1447Â°)       
Epoch  50/150 | Train MAE: 2.1033Â° | Val MAE: 1.3203Â° (Yaw=1.5410Â°, Pitch=1.2654Â°, Roll=1.1547Â°)       
Epoch  55/150 | Train MAE: 2.0514Â° | Val MAE: 1.3300Â° (Yaw=1.5784Â°, Pitch=1.3084Â°, Roll=1.1033Â°)       
Epoch  60/150 | Train MAE: 2.0289Â° | Val MAE: 1.1805Â° (Yaw=1.4205Â°, Pitch=1.1040Â°, Roll=1.0169Â°)       
   âœ“ New best model saved (Val MAE: 1.1805Â°)
Epoch  65/150 | Train MAE: 1.9875Â° | Val MAE: 1.1844Â° (Yaw=1.3934Â°, Pitch=1.1480Â°, Roll=1.0119Â°)       
Epoch  70/150 | Train MAE: 1.9424Â° | Val MAE: 1.1875Â° (Yaw=1.2891Â°, Pitch=1.2502Â°, Roll=1.0234Â°)       
Epoch  75/150 | Train MAE: 1.9646Â° | Val MAE: 1.2633Â° (Yaw=1.6027Â°, Pitch=1.1526Â°, Roll=1.0347Â°)       
Epoch  80/150 | Train MAE: 1.8990Â° | Val MAE: 1.1710Â° (Yaw=1.3858Â°, Pitch=1.1546Â°, Roll=0.9727Â°)       
Epoch  85/150 | Train MAE: 1.8395Â° | Val MAE: 1.2265Â° (Yaw=1.4744Â°, Pitch=1.2025Â°, Roll=1.0026Â°)       
Epoch  90/150 | Train MAE: 1.8352Â° | Val MAE: 1.1975Â° (Yaw=1.2944Â°, Pitch=1.2583Â°, Roll=1.0396Â°)       
Epoch  95/150 | Train MAE: 1.8056Â° | Val MAE: 1.2019Â° (Yaw=1.3237Â°, Pitch=1.2965Â°, Roll=0.9854Â°)       
Epoch 100/150 | Train MAE: 1.8545Â° | Val MAE: 1.2328Â° (Yaw=1.5604Â°, Pitch=1.1260Â°, Roll=1.0121Â°)       
Epoch 105/150 | Train MAE: 1.7737Â° | Val MAE: 1.1402Â° (Yaw=1.2974Â°, Pitch=1.1451Â°, Roll=0.9782Â°)       
Epoch 110/150 | Train MAE: 1.7439Â° | Val MAE: 1.0464Â° (Yaw=1.2036Â°, Pitch=0.9988Â°, Roll=0.9368Â°)       
Epoch 115/150 | Train MAE: 1.7347Â° | Val MAE: 1.0864Â° (Yaw=1.2659Â°, Pitch=1.0159Â°, Roll=0.9774Â°)       
Epoch 120/150 | Train MAE: 1.7328Â° | Val MAE: 1.0375Â° (Yaw=1.2511Â°, Pitch=0.9475Â°, Roll=0.9141Â°)       
Epoch 125/150 | Train MAE: 1.7104Â° | Val MAE: 1.0834Â° (Yaw=1.2640Â°, Pitch=1.0627Â°, Roll=0.9236Â°)       
Epoch 130/150 | Train MAE: 1.7175Â° | Val MAE: 1.0340Â° (Yaw=1.2235Â°, Pitch=0.9652Â°, Roll=0.9132Â°)       
                                                                                                       
Early stopping triggered after 132 epochs (no improvement for 20 epochs)

======================================================================
âœ… TRAINING COMPLETE!
======================================================================

ğŸ“Š Results:
   Best Val MAE:     1.0131Â°
   Yaw MAE:          1.1314Â°
   Pitch MAE:        0.9902Â°
   Roll MAE:         0.9178Â°
   Final Epoch:      132
   Model saved to:   models/ablation/dimension_attention/attention_efficientnet_b0_best_512:128.pth
   History saved to: models/ablation/dimension_attention/attention_efficientnet_b0_history_512:128.csv
   Parameters:       6,965,633

âœ… Fusion variant 'attention' training complete!
   Best validation MAE: 1.0131Â°

======================================================================
ğŸ“Š EVALUATING ATTENTION FUSION ON TEST SET
======================================================================
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=None`.
  warnings.warn(msg)
   Test samples: 3136
Testing: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 49/49 [00:59<00:00,  1.21s/it]

ğŸ“ˆ Test Results:
   Yaw MAE:   1.0683Â°
   Pitch MAE: 0.9748Â°
   Roll MAE:  0.9408Â°
   Mean MAE:  0.9946Â°

   Results saved to: results/csv_reports/dim_attention_512_128_test_results.csv

âœ… Test evaluation complete!
   Test MAE: 0.9946Â°

======================================================================
[2/5] Training attention fusion with dims 1024:256
======================================================================
======================================================================
ğŸ”— FUSION STRATEGY ABLATION: ATTENTION
======================================================================

ğŸ“‹ Configuration:
   Fusion Type: attention
   Backbone:    efficientnet_b0
   Face Dim:    1024
   Pose Dim:    256
   Epochs:      150
   Batch size:  64
   Output dir:  models/ablation/dimension_attention
   Device:      cuda

ğŸ” Checking data preprocessing...
âœ… Data preprocessing already complete - skipping
   Using splits from: data/splits

ğŸ“‚ Loading data splits...
   Train samples: 11758
   Val samples:   784
   Y mean: [  8.20929   -10.902234   -1.4025756]
   Y std:  [30.444633 24.493015 11.616344]

ğŸ—ï¸  Creating model...
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=EfficientNet_B0_Weights.IMAGENET1K_V1`. You can also use `weights=EfficientNet_B0_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
   Fusion Type:  attention
   Backbone:     efficientnet_b0
   Parameters:   7,557,377
   Model size:   28.83 MB

âš™ï¸  Setting up training...

ğŸš€ Starting training...
======================================================================
Epoch   1/150 | Train MAE: 10.8708Â° | Val MAE: 5.2060Â° (Yaw=7.8531Â°, Pitch=4.2600Â°, Roll=3.5050Â°)      
Epoch   5/150 | Train MAE: 3.9187Â° | Val MAE: 2.4729Â° (Yaw=2.9911Â°, Pitch=2.4434Â°, Roll=1.9842Â°)       
Epoch  10/150 | Train MAE: 3.2291Â° | Val MAE: 2.2161Â° (Yaw=2.4734Â°, Pitch=2.3178Â°, Roll=1.8571Â°)       
Epoch  15/150 | Train MAE: 2.8805Â° | Val MAE: 1.8578Â° (Yaw=2.0841Â°, Pitch=2.0090Â°, Roll=1.4804Â°)       
Epoch  20/150 | Train MAE: 2.6845Â° | Val MAE: 1.7796Â° (Yaw=1.9905Â°, Pitch=1.9333Â°, Roll=1.4152Â°)       
Epoch  25/150 | Train MAE: 2.5743Â° | Val MAE: 1.6116Â° (Yaw=1.8738Â°, Pitch=1.6267Â°, Roll=1.3342Â°)       
Epoch  30/150 | Train MAE: 2.4471Â° | Val MAE: 1.5425Â° (Yaw=1.9806Â°, Pitch=1.4922Â°, Roll=1.1547Â°)       
Epoch  35/150 | Train MAE: 2.3360Â° | Val MAE: 1.5966Â° (Yaw=2.0220Â°, Pitch=1.5164Â°, Roll=1.2515Â°)       
Epoch  40/150 | Train MAE: 2.2378Â° | Val MAE: 1.5915Â° (Yaw=1.8913Â°, Pitch=1.6312Â°, Roll=1.2519Â°)       
Epoch  45/150 | Train MAE: 2.2138Â° | Val MAE: 1.3617Â° (Yaw=1.7247Â°, Pitch=1.2621Â°, Roll=1.0982Â°)       
Epoch  50/150 | Train MAE: 2.1126Â° | Val MAE: 1.3830Â° (Yaw=1.7238Â°, Pitch=1.3840Â°, Roll=1.0412Â°)       
Epoch  55/150 | Train MAE: 2.0978Â° | Val MAE: 1.3499Â° (Yaw=1.6047Â°, Pitch=1.3574Â°, Roll=1.0876Â°)       
Epoch  60/150 | Train MAE: 2.0424Â° | Val MAE: 1.3134Â° (Yaw=1.5681Â°, Pitch=1.2312Â°, Roll=1.1410Â°)       
Epoch  65/150 | Train MAE: 1.9804Â° | Val MAE: 1.2296Â° (Yaw=1.5188Â°, Pitch=1.2228Â°, Roll=0.9471Â°)       
Epoch  70/150 | Train MAE: 1.9442Â° | Val MAE: 1.2321Â° (Yaw=1.3946Â°, Pitch=1.1848Â°, Roll=1.1171Â°)       
Epoch  75/150 | Train MAE: 1.9039Â° | Val MAE: 1.1356Â° (Yaw=1.3313Â°, Pitch=1.1198Â°, Roll=0.9557Â°)       
Epoch  80/150 | Train MAE: 1.9089Â° | Val MAE: 1.2456Â° (Yaw=1.4857Â°, Pitch=1.2122Â°, Roll=1.0390Â°)       
Epoch  85/150 | Train MAE: 1.8802Â° | Val MAE: 1.2071Â° (Yaw=1.4224Â°, Pitch=1.1051Â°, Roll=1.0939Â°)       
Epoch  90/150 | Train MAE: 1.8786Â° | Val MAE: 1.1400Â° (Yaw=1.3100Â°, Pitch=1.1155Â°, Roll=0.9943Â°)       
Epoch  95/150 | Train MAE: 1.8457Â° | Val MAE: 1.1116Â° (Yaw=1.2484Â°, Pitch=1.0831Â°, Roll=1.0034Â°)       
Epoch 100/150 | Train MAE: 1.8043Â° | Val MAE: 1.1126Â° (Yaw=1.3579Â°, Pitch=1.0185Â°, Roll=0.9615Â°)       
Epoch 105/150 | Train MAE: 1.7553Â° | Val MAE: 1.1142Â° (Yaw=1.3738Â°, Pitch=1.0387Â°, Roll=0.9302Â°)       
Epoch 110/150 | Train MAE: 1.7617Â° | Val MAE: 1.1432Â° (Yaw=1.4442Â°, Pitch=1.0817Â°, Roll=0.9037Â°)       
Epoch 115/150 | Train MAE: 1.7553Â° | Val MAE: 1.0250Â° (Yaw=1.1537Â°, Pitch=1.0044Â°, Roll=0.9170Â°)       
Epoch 120/150 | Train MAE: 1.7541Â° | Val MAE: 1.1728Â° (Yaw=1.3657Â°, Pitch=1.1935Â°, Roll=0.9592Â°)       
Epoch 125/150 | Train MAE: 1.7137Â° | Val MAE: 1.0482Â° (Yaw=1.2335Â°, Pitch=0.9908Â°, Roll=0.9202Â°)       
Epoch 130/150 | Train MAE: 1.7273Â° | Val MAE: 1.0870Â° (Yaw=1.1931Â°, Pitch=1.0848Â°, Roll=0.9830Â°)       
Epoch 135/150 | Train MAE: 1.6921Â° | Val MAE: 1.0181Â° (Yaw=1.1890Â°, Pitch=0.9728Â°, Roll=0.8925Â°)       
Epoch 140/150 | Train MAE: 1.6872Â° | Val MAE: 1.0633Â° (Yaw=1.3877Â°, Pitch=0.9146Â°, Roll=0.8875Â°)       
Epoch 145/150 | Train MAE: 1.6597Â° | Val MAE: 1.0478Â° (Yaw=1.2981Â°, Pitch=0.9388Â°, Roll=0.9065Â°)       
Epoch 150/150 | Train MAE: 1.6690Â° | Val MAE: 1.0269Â° (Yaw=1.2482Â°, Pitch=0.9634Â°, Roll=0.8691Â°)       

======================================================================
âœ… TRAINING COMPLETE!
======================================================================

ğŸ“Š Results:
   Best Val MAE:     0.9826Â°
   Yaw MAE:          1.0960Â°
   Pitch MAE:        1.0099Â°
   Roll MAE:         0.8418Â°
   Final Epoch:      150
   Model saved to:   models/ablation/dimension_attention/attention_efficientnet_b0_best_1024:256.pth
   History saved to: models/ablation/dimension_attention/attention_efficientnet_b0_history_1024:256.csv
   Parameters:       7,557,377

âœ… Fusion variant 'attention' training complete!
   Best validation MAE: 0.9826Â°

======================================================================
ğŸ“Š EVALUATING ATTENTION FUSION ON TEST SET
======================================================================
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=None`.
  warnings.warn(msg)
   Test samples: 3136
Testing: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 49/49 [00:11<00:00,  4.29it/s]

ğŸ“ˆ Test Results:
   Yaw MAE:   1.0891Â°
   Pitch MAE: 1.0132Â°
   Roll MAE:  0.9347Â°
   Mean MAE:  1.0123Â°

   Results saved to: results/csv_reports/dim_attention_1024_256_test_results.csv

âœ… Test evaluation complete!
   Test MAE: 1.0123Â°

======================================================================
[3/5] Training attention fusion with dims 768:768
======================================================================
======================================================================
ğŸ”— FUSION STRATEGY ABLATION: ATTENTION
======================================================================

ğŸ“‹ Configuration:
   Fusion Type: attention
   Backbone:    efficientnet_b0
   Face Dim:    768
   Pose Dim:    768
   Epochs:      150
   Batch size:  64
   Output dir:  models/ablation/dimension_attention
   Device:      cuda

ğŸ” Checking data preprocessing...
âœ… Data preprocessing already complete - skipping
   Using splits from: data/splits

ğŸ“‚ Loading data splits...
   Train samples: 11758
   Val samples:   784
   Y mean: [  8.20929   -10.902234   -1.4025756]
   Y std:  [30.444633 24.493015 11.616344]

ğŸ—ï¸  Creating model...
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=EfficientNet_B0_Weights.IMAGENET1K_V1`. You can also use `weights=EfficientNet_B0_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
   Fusion Type:  attention
   Backbone:     efficientnet_b0
   Parameters:   7,558,145
   Model size:   28.83 MB

âš™ï¸  Setting up training...

ğŸš€ Starting training...
======================================================================
Epoch   1/150 | Train MAE: 10.9928Â° | Val MAE: 5.2892Â° (Yaw=7.9520Â°, Pitch=4.3158Â°, Roll=3.5998Â°)      
Epoch   5/150 | Train MAE: 4.0608Â° | Val MAE: 2.7623Â° (Yaw=3.3559Â°, Pitch=2.7581Â°, Roll=2.1728Â°)       
Epoch  10/150 | Train MAE: 3.2640Â° | Val MAE: 2.4221Â° (Yaw=3.1089Â°, Pitch=2.3666Â°, Roll=1.7908Â°)       
Epoch  15/150 | Train MAE: 2.9519Â° | Val MAE: 1.9417Â° (Yaw=2.3272Â°, Pitch=1.9040Â°, Roll=1.5938Â°)       
Epoch  20/150 | Train MAE: 2.7483Â° | Val MAE: 1.7611Â° (Yaw=2.1611Â°, Pitch=1.7446Â°, Roll=1.3775Â°)       
   âœ“ New best model saved (Val MAE: 1.7611Â°)
Epoch  25/150 | Train MAE: 2.5668Â° | Val MAE: 1.9632Â° (Yaw=2.5132Â°, Pitch=1.9975Â°, Roll=1.3790Â°)       
Epoch  30/150 | Train MAE: 2.5297Â° | Val MAE: 1.5889Â° (Yaw=1.9072Â°, Pitch=1.5507Â°, Roll=1.3088Â°)       
   âœ“ New best model saved (Val MAE: 1.5889Â°)
Epoch  35/150 | Train MAE: 2.3722Â° | Val MAE: 1.5281Â° (Yaw=1.7991Â°, Pitch=1.5102Â°, Roll=1.2752Â°)       
Epoch  40/150 | Train MAE: 2.2642Â° | Val MAE: 1.5682Â° (Yaw=1.8110Â°, Pitch=1.5817Â°, Roll=1.3118Â°)       
Epoch  45/150 | Train MAE: 2.2106Â° | Val MAE: 1.5455Â° (Yaw=1.7986Â°, Pitch=1.6813Â°, Roll=1.1567Â°)       
Epoch  50/150 | Train MAE: 2.1483Â° | Val MAE: 1.3832Â° (Yaw=1.6539Â°, Pitch=1.4083Â°, Roll=1.0874Â°)       
Epoch  55/150 | Train MAE: 2.1156Â° | Val MAE: 1.3254Â° (Yaw=1.6532Â°, Pitch=1.2639Â°, Roll=1.0592Â°)       
Epoch  60/150 | Train MAE: 2.0458Â° | Val MAE: 1.3380Â° (Yaw=1.6522Â°, Pitch=1.2677Â°, Roll=1.0942Â°)       
Epoch  65/150 | Train MAE: 1.9934Â° | Val MAE: 1.2355Â° (Yaw=1.4020Â°, Pitch=1.2690Â°, Roll=1.0357Â°)       
Epoch  70/150 | Train MAE: 1.9424Â° | Val MAE: 1.2507Â° (Yaw=1.5348Â°, Pitch=1.2260Â°, Roll=0.9913Â°)       
Epoch  75/150 | Train MAE: 1.9087Â° | Val MAE: 1.2232Â° (Yaw=1.3841Â°, Pitch=1.2215Â°, Roll=1.0639Â°)       
Epoch  80/150 | Train MAE: 1.8968Â° | Val MAE: 1.1956Â° (Yaw=1.3891Â°, Pitch=1.2599Â°, Roll=0.9378Â°)       
Epoch  85/150 | Train MAE: 1.8692Â° | Val MAE: 1.2107Â° (Yaw=1.4542Â°, Pitch=1.1635Â°, Roll=1.0144Â°)       
Epoch  90/150 | Train MAE: 1.8403Â° | Val MAE: 1.1925Â° (Yaw=1.3540Â°, Pitch=1.2856Â°, Roll=0.9380Â°)       
Epoch  95/150 | Train MAE: 1.8324Â° | Val MAE: 1.1792Â° (Yaw=1.4586Â°, Pitch=1.1188Â°, Roll=0.9602Â°)       
Epoch 100/150 | Train MAE: 1.7886Â° | Val MAE: 1.0847Â° (Yaw=1.3203Â°, Pitch=1.0119Â°, Roll=0.9217Â°)       
   âœ“ New best model saved (Val MAE: 1.0847Â°)
Epoch 105/150 | Train MAE: 1.7885Â° | Val MAE: 1.1266Â° (Yaw=1.3321Â°, Pitch=1.0634Â°, Roll=0.9844Â°)       
Epoch 110/150 | Train MAE: 1.7946Â° | Val MAE: 1.0893Â° (Yaw=1.1901Â°, Pitch=1.1483Â°, Roll=0.9294Â°)       
Epoch 115/150 | Train MAE: 1.7353Â° | Val MAE: 1.1130Â° (Yaw=1.3759Â°, Pitch=1.0334Â°, Roll=0.9298Â°)       
Epoch 120/150 | Train MAE: 1.7413Â° | Val MAE: 1.1134Â° (Yaw=1.3295Â°, Pitch=1.1184Â°, Roll=0.8924Â°)       
Epoch 125/150 | Train MAE: 1.7376Â° | Val MAE: 1.1725Â° (Yaw=1.3665Â°, Pitch=1.1901Â°, Roll=0.9609Â°)       
Epoch 130/150 | Train MAE: 1.7127Â° | Val MAE: 1.0490Â° (Yaw=1.2248Â°, Pitch=1.0090Â°, Roll=0.9133Â°)       
Epoch 135/150 | Train MAE: 1.6963Â° | Val MAE: 1.1167Â° (Yaw=1.3112Â°, Pitch=1.0608Â°, Roll=0.9780Â°)       
Epoch 140/150 | Train MAE: 1.7024Â° | Val MAE: 1.0289Â° (Yaw=1.2238Â°, Pitch=1.0122Â°, Roll=0.8507Â°)       
   âœ“ New best model saved (Val MAE: 1.0289Â°)
Epoch 145/150 | Train MAE: 1.6703Â° | Val MAE: 1.0253Â° (Yaw=1.1060Â°, Pitch=1.0658Â°, Roll=0.9042Â°)       
Epoch 150/150 | Train MAE: 1.6638Â° | Val MAE: 1.1314Â° (Yaw=1.3314Â°, Pitch=1.1353Â°, Roll=0.9273Â°)       

======================================================================
âœ… TRAINING COMPLETE!
======================================================================

ğŸ“Š Results:
   Best Val MAE:     1.0253Â°
   Yaw MAE:          1.1060Â°
   Pitch MAE:        1.0658Â°
   Roll MAE:         0.9042Â°
   Final Epoch:      150
   Model saved to:   models/ablation/dimension_attention/attention_efficientnet_b0_best_768:768.pth
   History saved to: models/ablation/dimension_attention/attention_efficientnet_b0_history_768:768.csv
   Parameters:       7,558,145

âœ… Fusion variant 'attention' training complete!
   Best validation MAE: 1.0253Â°

======================================================================
ğŸ“Š EVALUATING ATTENTION FUSION ON TEST SET
======================================================================
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=None`.
  warnings.warn(msg)
   Test samples: 3136
Testing: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 49/49 [00:11<00:00,  4.29it/s]

ğŸ“ˆ Test Results:
   Yaw MAE:   1.1116Â°
   Pitch MAE: 0.9686Â°
   Roll MAE:  0.8979Â°
   Mean MAE:  0.9927Â°

   Results saved to: results/csv_reports/dim_attention_768_768_test_results.csv

âœ… Test evaluation complete!
   Test MAE: 0.9927Â°

======================================================================
[4/5] Training attention fusion with dims 2048:64
======================================================================
======================================================================
ğŸ”— FUSION STRATEGY ABLATION: ATTENTION
======================================================================

ğŸ“‹ Configuration:
   Fusion Type: attention
   Backbone:    efficientnet_b0
   Face Dim:    2048
   Pose Dim:    64
   Epochs:      150
   Batch size:  64
   Output dir:  models/ablation/dimension_attention
   Device:      cuda

ğŸ” Checking data preprocessing...
âœ… Data preprocessing already complete - skipping
   Using splits from: data/splits

ğŸ“‚ Loading data splits...
   Train samples: 11758
   Val samples:   784
   Y mean: [  8.20929   -10.902234   -1.4025756]
   Y std:  [30.444633 24.493015 11.616344]

ğŸ—ï¸  Creating model...
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=EfficientNet_B0_Weights.IMAGENET1K_V1`. You can also use `weights=EfficientNet_B0_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
   Fusion Type:  attention
   Backbone:     efficientnet_b0
   Parameters:   8,510,145
   Model size:   32.46 MB

âš™ï¸  Setting up training...

ğŸš€ Starting training...
======================================================================
Epoch   1/150 | Train MAE: 10.8244Â° | Val MAE: 5.6048Â° (Yaw=8.5918Â°, Pitch=4.4729Â°, Roll=3.7497Â°)      
Epoch   5/150 | Train MAE: 4.0252Â° | Val MAE: 2.8821Â° (Yaw=3.6015Â°, Pitch=2.8641Â°, Roll=2.1806Â°)       
Epoch  10/150 | Train MAE: 3.2656Â° | Val MAE: 1.9926Â° (Yaw=2.3931Â°, Pitch=1.9521Â°, Roll=1.6326Â°)       
   âœ“ New best model saved (Val MAE: 1.9926Â°)
Epoch  15/150 | Train MAE: 2.9074Â° | Val MAE: 1.9037Â° (Yaw=2.4318Â°, Pitch=1.7724Â°, Roll=1.5070Â°)       
Epoch  20/150 | Train MAE: 2.7174Â° | Val MAE: 1.8643Â° (Yaw=2.3835Â°, Pitch=1.7242Â°, Roll=1.4852Â°)       
Epoch  25/150 | Train MAE: 2.5762Â° | Val MAE: 1.7408Â° (Yaw=2.0078Â°, Pitch=1.9158Â°, Roll=1.2988Â°)       
Epoch  30/150 | Train MAE: 2.5595Â° | Val MAE: 1.5916Â° (Yaw=1.9532Â°, Pitch=1.5522Â°, Roll=1.2695Â°)       
Epoch  35/150 | Train MAE: 2.3935Â° | Val MAE: 1.6592Â° (Yaw=2.0451Â°, Pitch=1.6301Â°, Roll=1.3024Â°)       
Epoch  40/150 | Train MAE: 2.2673Â° | Val MAE: 1.4820Â° (Yaw=1.6511Â°, Pitch=1.5672Â°, Roll=1.2278Â°)       
Epoch  45/150 | Train MAE: 2.2299Â° | Val MAE: 1.4655Â° (Yaw=1.8159Â°, Pitch=1.4277Â°, Roll=1.1527Â°)       
Epoch  50/150 | Train MAE: 2.1637Â° | Val MAE: 1.3668Â° (Yaw=1.5457Â°, Pitch=1.4354Â°, Roll=1.1191Â°)       
   âœ“ New best model saved (Val MAE: 1.3668Â°)
Epoch  55/150 | Train MAE: 2.1773Â° | Val MAE: 1.4132Â° (Yaw=1.7896Â°, Pitch=1.3669Â°, Roll=1.0830Â°)       
Epoch  60/150 | Train MAE: 2.1083Â° | Val MAE: 1.2850Â° (Yaw=1.6346Â°, Pitch=1.1941Â°, Roll=1.0264Â°)       
   âœ“ New best model saved (Val MAE: 1.2850Â°)
Epoch  65/150 | Train MAE: 2.0070Â° | Val MAE: 1.2313Â° (Yaw=1.4595Â°, Pitch=1.1770Â°, Roll=1.0574Â°)       
Epoch  70/150 | Train MAE: 1.9862Â° | Val MAE: 1.2279Â° (Yaw=1.4686Â°, Pitch=1.2271Â°, Roll=0.9880Â°)       
   âœ“ New best model saved (Val MAE: 1.2279Â°)
Epoch  75/150 | Train MAE: 1.9604Â° | Val MAE: 1.3691Â° (Yaw=1.6567Â°, Pitch=1.3724Â°, Roll=1.0782Â°)       
Epoch  80/150 | Train MAE: 1.9082Â° | Val MAE: 1.3130Â° (Yaw=1.5188Â°, Pitch=1.3719Â°, Roll=1.0483Â°)       
Epoch  85/150 | Train MAE: 1.8993Â° | Val MAE: 1.3353Â° (Yaw=1.7318Â°, Pitch=1.2997Â°, Roll=0.9745Â°)       
Epoch  90/150 | Train MAE: 1.8509Â° | Val MAE: 1.1637Â° (Yaw=1.4584Â°, Pitch=1.0747Â°, Roll=0.9580Â°)       
   âœ“ New best model saved (Val MAE: 1.1637Â°)
Epoch  95/150 | Train MAE: 1.8378Â° | Val MAE: 1.1453Â° (Yaw=1.3473Â°, Pitch=1.1298Â°, Roll=0.9589Â°)       
Epoch 100/150 | Train MAE: 1.8208Â° | Val MAE: 1.1225Â° (Yaw=1.4116Â°, Pitch=1.0424Â°, Roll=0.9135Â°)       
   âœ“ New best model saved (Val MAE: 1.1225Â°)
Epoch 105/150 | Train MAE: 1.7978Â° | Val MAE: 1.1412Â° (Yaw=1.3434Â°, Pitch=1.1300Â°, Roll=0.9501Â°)       
Epoch 110/150 | Train MAE: 1.7766Â° | Val MAE: 1.1276Â° (Yaw=1.3762Â°, Pitch=1.0233Â°, Roll=0.9833Â°)       
Epoch 115/150 | Train MAE: 1.7695Â° | Val MAE: 1.1318Â° (Yaw=1.3342Â°, Pitch=1.0905Â°, Roll=0.9707Â°)       
Epoch 120/150 | Train MAE: 1.7629Â° | Val MAE: 1.0646Â° (Yaw=1.2179Â°, Pitch=1.0315Â°, Roll=0.9445Â°)       
   âœ“ New best model saved (Val MAE: 1.0646Â°)
Epoch 125/150 | Train MAE: 1.7656Â° | Val MAE: 1.1485Â° (Yaw=1.4183Â°, Pitch=1.0585Â°, Roll=0.9687Â°)       
Epoch 130/150 | Train MAE: 1.7515Â° | Val MAE: 1.1603Â° (Yaw=1.3677Â°, Pitch=1.1432Â°, Roll=0.9701Â°)       
Epoch 135/150 | Train MAE: 1.7375Â° | Val MAE: 1.1157Â° (Yaw=1.3371Â°, Pitch=1.0170Â°, Roll=0.9931Â°)       
Epoch 140/150 | Train MAE: 1.7045Â° | Val MAE: 1.2845Â° (Yaw=1.6565Â°, Pitch=1.2031Â°, Roll=0.9939Â°)       
Epoch 145/150 | Train MAE: 1.6782Â° | Val MAE: 1.1008Â° (Yaw=1.3415Â°, Pitch=1.0648Â°, Roll=0.8961Â°)       
Epoch 150/150 | Train MAE: 1.6694Â° | Val MAE: 1.0465Â° (Yaw=1.2204Â°, Pitch=1.0595Â°, Roll=0.8596Â°)       

======================================================================
âœ… TRAINING COMPLETE!
======================================================================

ğŸ“Š Results:
   Best Val MAE:     1.0079Â°
   Yaw MAE:          1.1199Â°
   Pitch MAE:        0.9904Â°
   Roll MAE:         0.9133Â°
   Final Epoch:      150
   Model saved to:   models/ablation/dimension_attention/attention_efficientnet_b0_best_2048:64.pth
   History saved to: models/ablation/dimension_attention/attention_efficientnet_b0_history_2048:64.csv
   Parameters:       8,510,145

âœ… Fusion variant 'attention' training complete!
   Best validation MAE: 1.0079Â°

======================================================================
ğŸ“Š EVALUATING ATTENTION FUSION ON TEST SET
======================================================================
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=None`.
  warnings.warn(msg)
   Test samples: 3136
Testing: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 49/49 [00:11<00:00,  4.27it/s]

ğŸ“ˆ Test Results:
   Yaw MAE:   1.1165Â°
   Pitch MAE: 0.9731Â°
   Roll MAE:  0.9402Â°
   Mean MAE:  1.0099Â°

   Results saved to: results/csv_reports/dim_attention_2048_64_test_results.csv

âœ… Test evaluation complete!
   Test MAE: 1.0099Â°

======================================================================
[5/5] Training attention fusion with dims 1404:99
======================================================================
======================================================================
ğŸ”— FUSION STRATEGY ABLATION: ATTENTION
======================================================================

ğŸ“‹ Configuration:
   Fusion Type: attention
   Backbone:    efficientnet_b0
   Face Dim:    1404
   Pose Dim:    99
   Epochs:      150
   Batch size:  64
   Output dir:  models/ablation/dimension_attention
   Device:      cuda

ğŸ” Checking data preprocessing...
âœ… Data preprocessing already complete - skipping
   Using splits from: data/splits

ğŸ“‚ Loading data splits...
   Train samples: 11758
   Val samples:   784
   Y mean: [  8.20929   -10.902234   -1.4025756]
   Y std:  [30.444633 24.493015 11.616344]

ğŸ—ï¸  Creating model...
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=EfficientNet_B0_Weights.IMAGENET1K_V1`. You can also use `weights=EfficientNet_B0_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
   Fusion Type:  attention
   Backbone:     efficientnet_b0
   Parameters:   7,866,782
   Model size:   30.01 MB

âš™ï¸  Setting up training...

ğŸš€ Starting training...
======================================================================
Epoch   1/150 | Train MAE: 11.0413Â° | Val MAE: 5.5585Â° (Yaw=7.6070Â°, Pitch=5.0867Â°, Roll=3.9818Â°)      
Epoch   5/150 | Train MAE: 3.9742Â° | Val MAE: 2.5049Â° (Yaw=2.9416Â°, Pitch=2.3998Â°, Roll=2.1733Â°)       
Epoch  10/150 | Train MAE: 3.2342Â° | Val MAE: 2.3365Â° (Yaw=2.7930Â°, Pitch=2.3378Â°, Roll=1.8787Â°)       
Epoch  15/150 | Train MAE: 3.0074Â° | Val MAE: 1.8196Â° (Yaw=2.1971Â°, Pitch=1.7539Â°, Roll=1.5078Â°)       
Epoch  20/150 | Train MAE: 2.6955Â° | Val MAE: 1.7580Â° (Yaw=2.3220Â°, Pitch=1.6077Â°, Roll=1.3442Â°)       
   âœ“ New best model saved (Val MAE: 1.7580Â°)
Epoch  25/150 | Train MAE: 2.5233Â° | Val MAE: 1.8258Â° (Yaw=2.0344Â°, Pitch=1.9434Â°, Roll=1.4996Â°)       
Epoch  30/150 | Train MAE: 2.4558Â° | Val MAE: 1.5973Â° (Yaw=2.0419Â°, Pitch=1.5166Â°, Roll=1.2333Â°)       
Epoch  35/150 | Train MAE: 2.3203Â° | Val MAE: 1.4970Â° (Yaw=1.8554Â°, Pitch=1.4322Â°, Roll=1.2034Â°)       
Epoch  40/150 | Train MAE: 2.2487Â° | Val MAE: 1.4881Â° (Yaw=1.7964Â°, Pitch=1.5097Â°, Roll=1.1583Â°)       
Epoch  45/150 | Train MAE: 2.2014Â° | Val MAE: 1.3865Â° (Yaw=1.6426Â°, Pitch=1.3745Â°, Roll=1.1425Â°)       
Epoch  50/150 | Train MAE: 2.1409Â° | Val MAE: 1.3540Â° (Yaw=1.6809Â°, Pitch=1.2900Â°, Roll=1.0910Â°)       
Epoch  55/150 | Train MAE: 2.0815Â° | Val MAE: 1.2648Â° (Yaw=1.5527Â°, Pitch=1.2022Â°, Roll=1.0394Â°)       
Epoch  60/150 | Train MAE: 2.0437Â° | Val MAE: 1.3075Â° (Yaw=1.5471Â°, Pitch=1.4031Â°, Roll=0.9724Â°)       
Epoch  65/150 | Train MAE: 2.0143Â° | Val MAE: 1.2874Â° (Yaw=1.4481Â°, Pitch=1.3315Â°, Roll=1.0825Â°)       
Epoch  70/150 | Train MAE: 1.9858Â° | Val MAE: 1.3325Â° (Yaw=1.5841Â°, Pitch=1.3228Â°, Roll=1.0905Â°)       
Epoch  75/150 | Train MAE: 1.9430Â° | Val MAE: 1.2677Â° (Yaw=1.4282Â°, Pitch=1.2594Â°, Roll=1.1154Â°)       
Epoch  80/150 | Train MAE: 1.9224Â° | Val MAE: 1.2245Â° (Yaw=1.4448Â°, Pitch=1.1998Â°, Roll=1.0289Â°)       
Epoch  85/150 | Train MAE: 1.8724Â° | Val MAE: 1.2322Â° (Yaw=1.4702Â°, Pitch=1.2334Â°, Roll=0.9931Â°)       
Epoch  90/150 | Train MAE: 1.8611Â° | Val MAE: 1.2953Â° (Yaw=1.6771Â°, Pitch=1.1383Â°, Roll=1.0704Â°)       
Epoch  95/150 | Train MAE: 1.8329Â° | Val MAE: 1.2565Â° (Yaw=1.5153Â°, Pitch=1.1997Â°, Roll=1.0545Â°)       
Epoch 100/150 | Train MAE: 1.8035Â° | Val MAE: 1.1693Â° (Yaw=1.3195Â°, Pitch=1.2193Â°, Roll=0.9691Â°)       
Epoch 105/150 | Train MAE: 1.7862Â° | Val MAE: 1.2546Â° (Yaw=1.4665Â°, Pitch=1.2921Â°, Roll=1.0052Â°)       
Epoch 110/150 | Train MAE: 1.7837Â° | Val MAE: 1.1606Â° (Yaw=1.3479Â°, Pitch=1.1506Â°, Roll=0.9832Â°)       
Epoch 115/150 | Train MAE: 1.7537Â° | Val MAE: 1.0758Â° (Yaw=1.1841Â°, Pitch=1.1366Â°, Roll=0.9066Â°)       
Epoch 120/150 | Train MAE: 1.7405Â° | Val MAE: 1.1310Â° (Yaw=1.2783Â°, Pitch=1.1625Â°, Roll=0.9522Â°)       
Epoch 125/150 | Train MAE: 1.7254Â° | Val MAE: 1.1366Â° (Yaw=1.3776Â°, Pitch=1.0725Â°, Roll=0.9597Â°)       
Epoch 130/150 | Train MAE: 1.7088Â° | Val MAE: 1.1456Â° (Yaw=1.3519Â°, Pitch=1.1049Â°, Roll=0.9800Â°)       
Epoch 135/150 | Train MAE: 1.7000Â° | Val MAE: 1.1093Â° (Yaw=1.2608Â°, Pitch=1.1026Â°, Roll=0.9645Â°)       
Epoch 140/150 | Train MAE: 1.6757Â° | Val MAE: 1.0907Â° (Yaw=1.2493Â°, Pitch=1.0846Â°, Roll=0.9382Â°)       
Epoch 145/150 | Train MAE: 1.6775Â° | Val MAE: 1.1199Â° (Yaw=1.3765Â°, Pitch=1.0437Â°, Roll=0.9395Â°)       
Epoch 150/150 | Train MAE: 1.6755Â° | Val MAE: 1.0574Â° (Yaw=1.2426Â°, Pitch=1.0750Â°, Roll=0.8545Â°)       

======================================================================
âœ… TRAINING COMPLETE!
======================================================================

ğŸ“Š Results:
   Best Val MAE:     0.9885Â°
   Yaw MAE:          1.0801Â°
   Pitch MAE:        0.9894Â°
   Roll MAE:         0.8959Â°
   Final Epoch:      150
   Model saved to:   models/ablation/dimension_attention/attention_efficientnet_b0_best_1404:99.pth
   History saved to: models/ablation/dimension_attention/attention_efficientnet_b0_history_1404:99.csv
   Parameters:       7,866,782

âœ… Fusion variant 'attention' training complete!
   Best validation MAE: 0.9885Â°

======================================================================
ğŸ“Š EVALUATING ATTENTION FUSION ON TEST SET
======================================================================
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=None`.
  warnings.warn(msg)
   Test samples: 3136
Testing: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 49/49 [00:11<00:00,  4.28it/s]

ğŸ“ˆ Test Results:
   Yaw MAE:   1.0680Â°
   Pitch MAE: 0.9202Â°
   Roll MAE:  0.8940Â°
   Mean MAE:  0.9607Â°

   Results saved to: results/csv_reports/dim_attention_1404_99_test_results.csv

âœ… Test evaluation complete!
   Test MAE: 0.9607Â°

======================================================================
âœ… ALL 5 DIMENSION ABLATION EXPERIMENTS COMPLETE!
======================================================================
Results saved to: results/csv_reports/dim_attention_*_test_results.csv
Models saved to:  models/ablation/dimension_attention/
(venv) âœ  Archive git:(main) âœ— 


==================

BACKBONE ABLATION

==================

y%                                                                                                     
âœ  Archive git:(main) âœ— y
âœ  Archive git:(main) âœ— source /home/genesys/hamza/cervical/Archive/venv/bin/activate
(venv) âœ  Archive git:(main) âœ— ./run_backbone_ablation.sh 
======================================================================
ğŸš€ BACKBONE ABLATION (ATTENTION FUSION 1404:99) - Starting all experiments
======================================================================

======================================================================
[1/5] Training with ResNet34
======================================================================
======================================================================
ğŸ”— FUSION STRATEGY ABLATION: ATTENTION
======================================================================

ğŸ“‹ Configuration:
   Fusion Type: attention
   Backbone:    resnet34
   Face Dim:    1404
   Pose Dim:    99
   Epochs:      150
   Batch size:  64
   Output dir:  models/ablation/backbone
   Device:      cuda

ğŸ” Checking data preprocessing...
âœ… Data preprocessing already complete - skipping
   Using splits from: data/splits

ğŸ“‚ Loading data splits...
   Train samples: 11758
   Val samples:   784
   Y mean: [  8.20929   -10.902234   -1.4025756]
   Y std:  [30.444633 24.493015 11.616344]

ğŸ—ï¸  Creating model...
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet34_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet34_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
   Fusion Type:  attention
   Backbone:     resnet34
   Parameters:   24,357,474
   Model size:   92.92 MB

âš™ï¸  Setting up training...

ğŸš€ Starting training...
======================================================================
Epoch   1/150 | Train MAE: 8.8489Â° | Val MAE: 4.5242Â° (Yaw=6.3520Â°, Pitch=3.7205Â°, Roll=3.5002Â°)       
Epoch   5/150 | Train MAE: 3.5682Â° | Val MAE: 2.7281Â° (Yaw=3.1771Â°, Pitch=2.8675Â°, Roll=2.1398Â°)       
Epoch  10/150 | Train MAE: 2.9880Â° | Val MAE: 2.0897Â° (Yaw=2.7736Â°, Pitch=1.9685Â°, Roll=1.5271Â°)       
   âœ“ New best model saved (Val MAE: 2.0897Â°)
Epoch  15/150 | Train MAE: 2.7451Â° | Val MAE: 2.1057Â° (Yaw=2.3628Â°, Pitch=2.0994Â°, Roll=1.8550Â°)       
Epoch  20/150 | Train MAE: 2.5201Â° | Val MAE: 1.5086Â° (Yaw=1.8077Â°, Pitch=1.5110Â°, Roll=1.2071Â°)       
   âœ“ New best model saved (Val MAE: 1.5086Â°)
Epoch  25/150 | Train MAE: 2.4269Â° | Val MAE: 1.7681Â° (Yaw=2.2674Â°, Pitch=1.6743Â°, Roll=1.3625Â°)       
Epoch  30/150 | Train MAE: 2.5182Â° | Val MAE: 1.9887Â° (Yaw=2.6538Â°, Pitch=1.9724Â°, Roll=1.3399Â°)       
Epoch  35/150 | Train MAE: 2.2610Â° | Val MAE: 1.7110Â° (Yaw=2.3868Â°, Pitch=1.3920Â°, Roll=1.3542Â°)       
Epoch  40/150 | Train MAE: 2.2812Â° | Val MAE: 1.7311Â° (Yaw=2.1968Â°, Pitch=1.5392Â°, Roll=1.4574Â°)       
Epoch  45/150 | Train MAE: 2.1279Â° | Val MAE: 1.4110Â° (Yaw=1.6636Â°, Pitch=1.4454Â°, Roll=1.1240Â°)       
Epoch  50/150 | Train MAE: 2.1253Â° | Val MAE: 1.4560Â° (Yaw=1.7615Â°, Pitch=1.4745Â°, Roll=1.1321Â°)       
Epoch  55/150 | Train MAE: 2.3280Â° | Val MAE: 1.5711Â° (Yaw=2.0115Â°, Pitch=1.4780Â°, Roll=1.2239Â°)       
Epoch  60/150 | Train MAE: 2.0255Â° | Val MAE: 1.3638Â° (Yaw=1.4574Â°, Pitch=1.5712Â°, Roll=1.0627Â°)       
   âœ“ New best model saved (Val MAE: 1.3638Â°)
Epoch  65/150 | Train MAE: 2.0254Â° | Val MAE: 1.3984Â° (Yaw=1.8859Â°, Pitch=1.1083Â°, Roll=1.2010Â°)       
Epoch  70/150 | Train MAE: 1.9777Â° | Val MAE: 1.4182Â° (Yaw=1.7909Â°, Pitch=1.2628Â°, Roll=1.2009Â°)       
Epoch  75/150 | Train MAE: 1.9562Â° | Val MAE: 1.2170Â° (Yaw=1.4124Â°, Pitch=1.1796Â°, Roll=1.0591Â°)       
Epoch  80/150 | Train MAE: 1.9425Â° | Val MAE: 1.5233Â° (Yaw=1.9853Â°, Pitch=1.5321Â°, Roll=1.0525Â°)       
Epoch  85/150 | Train MAE: 1.8775Â° | Val MAE: 1.2752Â° (Yaw=1.5922Â°, Pitch=1.1318Â°, Roll=1.1017Â°)       
Epoch  90/150 | Train MAE: 1.9013Â° | Val MAE: 1.3122Â° (Yaw=1.6426Â°, Pitch=1.1791Â°, Roll=1.1150Â°)       
Epoch  95/150 | Train MAE: 1.8620Â° | Val MAE: 1.3467Â° (Yaw=1.5783Â°, Pitch=1.3304Â°, Roll=1.1313Â°)       
Epoch 100/150 | Train MAE: 1.8232Â° | Val MAE: 1.2550Â° (Yaw=1.5402Â°, Pitch=1.2587Â°, Roll=0.9659Â°)       
Epoch 105/150 | Train MAE: 1.8393Â° | Val MAE: 1.2148Â° (Yaw=1.5761Â°, Pitch=1.0792Â°, Roll=0.9890Â°)       
Epoch 110/150 | Train MAE: 1.8065Â° | Val MAE: 1.2869Â° (Yaw=1.5760Â°, Pitch=1.1873Â°, Roll=1.0974Â°)       
Epoch 115/150 | Train MAE: 1.7890Â° | Val MAE: 1.2595Â° (Yaw=1.5773Â°, Pitch=1.1876Â°, Roll=1.0136Â°)       
Epoch 120/150 | Train MAE: 1.7747Â° | Val MAE: 1.2072Â° (Yaw=1.4471Â°, Pitch=1.1412Â°, Roll=1.0334Â°)       
Epoch 125/150 | Train MAE: 1.7496Â° | Val MAE: 1.1644Â° (Yaw=1.3415Â°, Pitch=1.1495Â°, Roll=1.0022Â°)       
Epoch 130/150 | Train MAE: 1.7549Â° | Val MAE: 1.2516Â° (Yaw=1.4436Â°, Pitch=1.1996Â°, Roll=1.1115Â°)       
Epoch 135/150 | Train MAE: 1.7196Â° | Val MAE: 1.2361Â° (Yaw=1.7176Â°, Pitch=1.0727Â°, Roll=0.9181Â°)       
Epoch 140/150 | Train MAE: 1.7030Â° | Val MAE: 1.1434Â° (Yaw=1.3380Â°, Pitch=1.1305Â°, Roll=0.9618Â°)       
Epoch 145/150 | Train MAE: 1.6914Â° | Val MAE: 1.1913Â° (Yaw=1.3799Â°, Pitch=1.2142Â°, Roll=0.9798Â°)       
Epoch 150/150 | Train MAE: 1.6785Â° | Val MAE: 1.2354Â° (Yaw=1.4536Â°, Pitch=1.2301Â°, Roll=1.0225Â°)       

======================================================================
âœ… TRAINING COMPLETE!
======================================================================

ğŸ“Š Results:
   Best Val MAE:     1.0908Â°
   Yaw MAE:          1.2551Â°
   Pitch MAE:        1.0552Â°
   Roll MAE:         0.9622Â°
   Final Epoch:      150
   Model saved to:   models/ablation/backbone/attention_resnet34_best.pth
   History saved to: models/ablation/backbone/attention_resnet34_history.csv
   Parameters:       24,357,474

âœ… Fusion variant 'attention' training complete!
   Best validation MAE: 1.0908Â°

======================================================================
ğŸ“Š EVALUATING ATTENTION FUSION ON TEST SET
======================================================================
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=None`.
  warnings.warn(msg)
   Test samples: 3136
Testing: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 49/49 [00:59<00:00,  1.22s/it]

ğŸ“ˆ Test Results:
   Yaw MAE:   1.1892Â°
   Pitch MAE: 1.0200Â°
   Roll MAE:  0.9584Â°
   Mean MAE:  1.0559Â°

   Results saved to: results/csv_reports/backbone_resnet34_test_results.csv

âœ… Test evaluation complete!
   Test MAE: 1.0559Â°

======================================================================
[2/5] Training with ResNet18
======================================================================
======================================================================
ğŸ”— FUSION STRATEGY ABLATION: ATTENTION
======================================================================

ğŸ“‹ Configuration:
   Fusion Type: attention
   Backbone:    resnet18
   Face Dim:    1404
   Pose Dim:    99
   Epochs:      150
   Batch size:  64
   Output dir:  models/ablation/backbone
   Device:      cuda

ğŸ” Checking data preprocessing...
âœ… Data preprocessing already complete - skipping
   Using splits from: data/splits

ğŸ“‚ Loading data splits...
   Train samples: 11758
   Val samples:   784
   Y mean: [  8.20929   -10.902234   -1.4025756]
   Y std:  [30.444633 24.493015 11.616344]

ğŸ—ï¸  Creating model...
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet18_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet18_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
   Fusion Type:  attention
   Backbone:     resnet18
   Parameters:   14,249,314
   Model size:   54.36 MB

âš™ï¸  Setting up training...

ğŸš€ Starting training...
======================================================================
Epoch   1/150 | Train MAE: 8.9943Â° | Val MAE: 4.0956Â° (Yaw=5.4079Â°, Pitch=3.5835Â°, Roll=3.2955Â°)       
Epoch   5/150 | Train MAE: 3.5729Â° | Val MAE: 3.1360Â° (Yaw=3.8972Â°, Pitch=3.0138Â°, Roll=2.4970Â°)       
Epoch  10/150 | Train MAE: 3.0055Â° | Val MAE: 2.0225Â° (Yaw=2.3363Â°, Pitch=2.1387Â°, Roll=1.5926Â°)       
Epoch  15/150 | Train MAE: 2.7150Â° | Val MAE: 1.9648Â° (Yaw=2.4710Â°, Pitch=1.8243Â°, Roll=1.5990Â°)       
Epoch  20/150 | Train MAE: 2.5930Â° | Val MAE: 1.6974Â° (Yaw=1.9603Â°, Pitch=1.7680Â°, Roll=1.3640Â°)       
   âœ“ New best model saved (Val MAE: 1.6974Â°)
Epoch  25/150 | Train MAE: 2.4680Â° | Val MAE: 1.8027Â° (Yaw=2.1709Â°, Pitch=1.8060Â°, Roll=1.4312Â°)       
Epoch  30/150 | Train MAE: 2.3634Â° | Val MAE: 1.6565Â° (Yaw=1.9968Â°, Pitch=1.7190Â°, Roll=1.2538Â°)       
Epoch  35/150 | Train MAE: 2.3007Â° | Val MAE: 1.5886Â° (Yaw=2.0473Â°, Pitch=1.4893Â°, Roll=1.2293Â°)       
Epoch  40/150 | Train MAE: 2.8971Â° | Val MAE: 1.8225Â° (Yaw=2.1903Â°, Pitch=1.8435Â°, Roll=1.4336Â°)       
Epoch  45/150 | Train MAE: 2.1744Â° | Val MAE: 1.3910Â° (Yaw=1.6179Â°, Pitch=1.2597Â°, Roll=1.2955Â°)       
Epoch  50/150 | Train MAE: 2.1194Â° | Val MAE: 1.2997Â° (Yaw=1.5380Â°, Pitch=1.2803Â°, Roll=1.0807Â°)       
   âœ“ New best model saved (Val MAE: 1.2997Â°)
Epoch  55/150 | Train MAE: 2.0767Â° | Val MAE: 1.3395Â° (Yaw=1.5573Â°, Pitch=1.2641Â°, Roll=1.1970Â°)       
Epoch  60/150 | Train MAE: 2.0483Â° | Val MAE: 1.3045Â° (Yaw=1.6064Â°, Pitch=1.2473Â°, Roll=1.0599Â°)       
Epoch  65/150 | Train MAE: 2.1526Â° | Val MAE: 2.6348Â° (Yaw=3.0617Â°, Pitch=2.5763Â°, Roll=2.2665Â°)       
Epoch  70/150 | Train MAE: 1.9897Â° | Val MAE: 1.2531Â° (Yaw=1.5251Â°, Pitch=1.1660Â°, Roll=1.0680Â°)       
   âœ“ New best model saved (Val MAE: 1.2531Â°)
Epoch  75/150 | Train MAE: 1.9291Â° | Val MAE: 1.2680Â° (Yaw=1.6422Â°, Pitch=1.1786Â°, Roll=0.9832Â°)       
Epoch  80/150 | Train MAE: 1.9135Â° | Val MAE: 1.3731Â° (Yaw=1.7503Â°, Pitch=1.3086Â°, Roll=1.0602Â°)       
Epoch  85/150 | Train MAE: 1.9019Â° | Val MAE: 1.2534Â° (Yaw=1.5062Â°, Pitch=1.2725Â°, Roll=0.9815Â°)       
Epoch  90/150 | Train MAE: 1.8857Â° | Val MAE: 1.2219Â° (Yaw=1.4995Â°, Pitch=1.1481Â°, Roll=1.0182Â°)       
Epoch  95/150 | Train MAE: 1.8486Â° | Val MAE: 1.4549Â° (Yaw=1.8320Â°, Pitch=1.3518Â°, Roll=1.1811Â°)       
Epoch 100/150 | Train MAE: 1.8355Â° | Val MAE: 1.1957Â° (Yaw=1.4948Â°, Pitch=1.1331Â°, Roll=0.9593Â°)       
Epoch 105/150 | Train MAE: 1.8314Â° | Val MAE: 1.2505Â° (Yaw=1.3996Â°, Pitch=1.2871Â°, Roll=1.0649Â°)       
                                                                                                       
Early stopping triggered after 107 epochs (no improvement for 20 epochs)

======================================================================
âœ… TRAINING COMPLETE!
======================================================================

ğŸ“Š Results:
   Best Val MAE:     1.1701Â°
   Yaw MAE:          1.4141Â°
   Pitch MAE:        1.0762Â°
   Roll MAE:         1.0199Â°
   Final Epoch:      107
   Model saved to:   models/ablation/backbone/attention_resnet18_best.pth
   History saved to: models/ablation/backbone/attention_resnet18_history.csv
   Parameters:       14,249,314

âœ… Fusion variant 'attention' training complete!
   Best validation MAE: 1.1701Â°

======================================================================
ğŸ“Š EVALUATING ATTENTION FUSION ON TEST SET
======================================================================
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=None`.
  warnings.warn(msg)
   Test samples: 3136
Testing: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 49/49 [00:11<00:00,  4.36it/s]

ğŸ“ˆ Test Results:
   Yaw MAE:   1.4204Â°
   Pitch MAE: 1.0569Â°
   Roll MAE:  1.0414Â°
   Mean MAE:  1.1729Â°

   Results saved to: results/csv_reports/backbone_resnet18_test_results.csv

âœ… Test evaluation complete!
   Test MAE: 1.1729Â°

======================================================================
[3/5] Training with ResNet50
======================================================================
======================================================================
ğŸ”— FUSION STRATEGY ABLATION: ATTENTION
======================================================================

ğŸ“‹ Configuration:
   Fusion Type: attention
   Backbone:    resnet50
   Face Dim:    1404
   Pose Dim:    99
   Epochs:      150
   Batch size:  64
   Output dir:  models/ablation/backbone
   Device:      cuda

ğŸ” Checking data preprocessing...
âœ… Data preprocessing already complete - skipping
   Using splits from: data/splits

ğŸ“‚ Loading data splits...
   Train samples: 11758
   Val samples:   784
   Y mean: [  8.20929   -10.902234   -1.4025756]
   Y std:  [30.444633 24.493015 11.616344]

ğŸ—ï¸  Creating model...
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
   Fusion Type:  attention
   Backbone:     resnet50
   Parameters:   28,153,698
   Model size:   107.40 MB

âš™ï¸  Setting up training...

ğŸš€ Starting training...
======================================================================
Epoch   1/150 | Train MAE: 8.3296Â° | Val MAE: 4.0158Â° (Yaw=4.8694Â°, Pitch=4.2349Â°, Roll=2.9432Â°)       
Epoch   5/150 | Train MAE: 3.3901Â° | Val MAE: 2.4270Â° (Yaw=3.3545Â°, Pitch=2.1256Â°, Roll=1.8010Â°)       
Epoch  10/150 | Train MAE: 2.8838Â° | Val MAE: 2.0965Â° (Yaw=2.4687Â°, Pitch=2.1451Â°, Roll=1.6756Â°)       
   âœ“ New best model saved (Val MAE: 2.0965Â°)
Epoch  15/150 | Train MAE: 2.6599Â° | Val MAE: 1.8396Â° (Yaw=2.6455Â°, Pitch=1.5225Â°, Roll=1.3506Â°)       
Epoch  20/150 | Train MAE: 2.5442Â° | Val MAE: 1.9025Â° (Yaw=2.6026Â°, Pitch=1.8460Â°, Roll=1.2587Â°)       
Epoch  25/150 | Train MAE: 2.4182Â° | Val MAE: 1.8126Â° (Yaw=2.0336Â°, Pitch=1.9424Â°, Roll=1.4616Â°)       
Epoch  30/150 | Train MAE: 2.3571Â° | Val MAE: 1.5474Â° (Yaw=1.9091Â°, Pitch=1.3620Â°, Roll=1.3711Â°)       
   âœ“ New best model saved (Val MAE: 1.5474Â°)
Epoch  35/150 | Train MAE: 2.2014Â° | Val MAE: 1.4765Â° (Yaw=1.9237Â°, Pitch=1.4124Â°, Roll=1.0934Â°)       
Epoch  40/150 | Train MAE: 2.2176Â° | Val MAE: 1.7554Â° (Yaw=2.2169Â°, Pitch=1.7113Â°, Roll=1.3380Â°)       
Epoch  45/150 | Train MAE: 2.1582Â° | Val MAE: 1.4865Â° (Yaw=1.6466Â°, Pitch=1.5696Â°, Roll=1.2435Â°)       
Epoch  50/150 | Train MAE: 2.0865Â° | Val MAE: 1.8135Â° (Yaw=1.9777Â°, Pitch=2.0261Â°, Roll=1.4368Â°)       
Epoch  55/150 | Train MAE: 2.0652Â° | Val MAE: 1.3055Â° (Yaw=1.4473Â°, Pitch=1.3998Â°, Roll=1.0694Â°)       
Epoch  60/150 | Train MAE: 2.0331Â° | Val MAE: 1.3417Â° (Yaw=1.5564Â°, Pitch=1.3114Â°, Roll=1.1573Â°)       
Epoch  65/150 | Train MAE: 1.9946Â° | Val MAE: 1.3119Â° (Yaw=1.5890Â°, Pitch=1.3444Â°, Roll=1.0022Â°)       
Epoch  70/150 | Train MAE: 1.9861Â° | Val MAE: 1.3940Â° (Yaw=1.6421Â°, Pitch=1.3139Â°, Roll=1.2260Â°)       
Epoch  75/150 | Train MAE: 1.9571Â° | Val MAE: 1.3000Â° (Yaw=1.5036Â°, Pitch=1.3271Â°, Roll=1.0693Â°)       
Epoch  80/150 | Train MAE: 2.4694Â° | Val MAE: 1.4433Â° (Yaw=1.8029Â°, Pitch=1.4377Â°, Roll=1.0893Â°)       
Epoch  85/150 | Train MAE: 1.8566Â° | Val MAE: 1.1017Â° (Yaw=1.1982Â°, Pitch=1.1101Â°, Roll=0.9969Â°)       
Epoch  90/150 | Train MAE: 1.8082Â° | Val MAE: 1.2911Â° (Yaw=1.4188Â°, Pitch=1.4315Â°, Roll=1.0230Â°)       
Epoch  95/150 | Train MAE: 1.8203Â° | Val MAE: 1.3327Â° (Yaw=1.5184Â°, Pitch=1.3019Â°, Roll=1.1779Â°)       
Epoch 100/150 | Train MAE: 1.8038Â° | Val MAE: 1.2455Â° (Yaw=1.4033Â°, Pitch=1.2677Â°, Roll=1.0654Â°)       
Epoch 105/150 | Train MAE: 1.8003Â° | Val MAE: 1.2357Â° (Yaw=1.6018Â°, Pitch=1.1455Â°, Roll=0.9599Â°)       

Early stopping triggered after 105 epochs (no improvement for 20 epochs)

======================================================================
âœ… TRAINING COMPLETE!
======================================================================

ğŸ“Š Results:
   Best Val MAE:     1.1017Â°
   Yaw MAE:          1.1982Â°
   Pitch MAE:        1.1101Â°
   Roll MAE:         0.9969Â°
   Final Epoch:      105
   Model saved to:   models/ablation/backbone/attention_resnet50_best.pth
   History saved to: models/ablation/backbone/attention_resnet50_history.csv
   Parameters:       28,153,698

âœ… Fusion variant 'attention' training complete!
   Best validation MAE: 1.1017Â°

======================================================================
ğŸ“Š EVALUATING ATTENTION FUSION ON TEST SET
======================================================================
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=None`.
  warnings.warn(msg)
   Test samples: 3136
Testing: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 49/49 [00:11<00:00,  4.29it/s]

ğŸ“ˆ Test Results:
   Yaw MAE:   1.1374Â°
   Pitch MAE: 1.0874Â°
   Roll MAE:  1.0124Â°
   Mean MAE:  1.0791Â°

   Results saved to: results/csv_reports/backbone_resnet50_test_results.csv

âœ… Test evaluation complete!
   Test MAE: 1.0791Â°

======================================================================
[4/5] Training with MobileNetV3-Large
======================================================================
======================================================================
ğŸ”— FUSION STRATEGY ABLATION: ATTENTION
======================================================================

ğŸ“‹ Configuration:
   Fusion Type: attention
   Backbone:    mobilenet_v3_large
   Face Dim:    1404
   Pose Dim:    99
   Epochs:      150
   Batch size:  64
   Output dir:  models/ablation/backbone
   Device:      cuda

ğŸ” Checking data preprocessing...
âœ… Data preprocessing already complete - skipping
   Using splits from: data/splits

ğŸ“‚ Loading data splits...
   Train samples: 11758
   Val samples:   784
   Y mean: [  8.20929   -10.902234   -1.4025756]
   Y std:  [30.444633 24.493015 11.616344]

ğŸ—ï¸  Creating model...
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V3_Large_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V3_Large_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
   Fusion Type:  attention
   Backbone:     mobilenet_v3_large
   Parameters:   6,503,506
   Model size:   24.81 MB

âš™ï¸  Setting up training...

ğŸš€ Starting training...
======================================================================
Epoch   1/150 | Train MAE: 10.2730Â° | Val MAE: 5.6986Â° (Yaw=8.0117Â°, Pitch=5.2397Â°, Roll=3.8444Â°)      
Epoch   5/150 | Train MAE: 3.7532Â° | Val MAE: 2.6772Â° (Yaw=3.5970Â°, Pitch=2.5309Â°, Roll=1.9038Â°)       
Epoch  10/150 | Train MAE: 3.1382Â° | Val MAE: 2.1453Â° (Yaw=2.7622Â°, Pitch=1.9713Â°, Roll=1.7024Â°)       
   âœ“ New best model saved (Val MAE: 2.1453Â°)
Epoch  15/150 | Train MAE: 2.8756Â° | Val MAE: 2.0132Â° (Yaw=2.7768Â°, Pitch=1.6321Â°, Roll=1.6309Â°)       
Epoch  20/150 | Train MAE: 2.6350Â° | Val MAE: 1.8535Â° (Yaw=2.3060Â°, Pitch=1.8885Â°, Roll=1.3659Â°)       
Epoch  25/150 | Train MAE: 2.5400Â° | Val MAE: 1.6612Â° (Yaw=1.9890Â°, Pitch=1.7377Â°, Roll=1.2570Â°)       
Epoch  30/150 | Train MAE: 2.4369Â° | Val MAE: 1.6914Â° (Yaw=1.9438Â°, Pitch=1.8033Â°, Roll=1.3270Â°)       
Epoch  35/150 | Train MAE: 2.3384Â° | Val MAE: 1.7168Â° (Yaw=2.3098Â°, Pitch=1.5460Â°, Roll=1.2946Â°)       
Epoch  40/150 | Train MAE: 2.2508Â° | Val MAE: 1.4488Â° (Yaw=1.6285Â°, Pitch=1.4620Â°, Roll=1.2557Â°)       
Epoch  45/150 | Train MAE: 2.1868Â° | Val MAE: 1.4260Â° (Yaw=1.8576Â°, Pitch=1.3072Â°, Roll=1.1134Â°)       
Epoch  50/150 | Train MAE: 2.1674Â° | Val MAE: 1.4938Â° (Yaw=1.7597Â°, Pitch=1.5857Â°, Roll=1.1362Â°)       
Epoch  55/150 | Train MAE: 2.0485Â° | Val MAE: 1.3755Â° (Yaw=1.6389Â°, Pitch=1.3077Â°, Roll=1.1800Â°)       
Epoch  60/150 | Train MAE: 2.0439Â° | Val MAE: 1.3870Â° (Yaw=1.6645Â°, Pitch=1.4279Â°, Roll=1.0685Â°)       
Epoch  65/150 | Train MAE: 2.0132Â° | Val MAE: 1.3456Â° (Yaw=1.5618Â°, Pitch=1.4485Â°, Roll=1.0266Â°)       
Epoch  70/150 | Train MAE: 1.9614Â° | Val MAE: 1.3210Â° (Yaw=1.6688Â°, Pitch=1.2494Â°, Roll=1.0447Â°)       
Epoch  75/150 | Train MAE: 1.9316Â° | Val MAE: 1.2893Â° (Yaw=1.4427Â°, Pitch=1.3312Â°, Roll=1.0941Â°)       
Epoch  80/150 | Train MAE: 1.9039Â° | Val MAE: 1.2703Â° (Yaw=1.5743Â°, Pitch=1.1856Â°, Roll=1.0510Â°)       
Epoch  85/150 | Train MAE: 1.8853Â° | Val MAE: 1.2877Â° (Yaw=1.6756Â°, Pitch=1.1719Â°, Roll=1.0157Â°)       
Epoch  90/150 | Train MAE: 1.8647Â° | Val MAE: 1.2266Â° (Yaw=1.4682Â°, Pitch=1.2303Â°, Roll=0.9814Â°)       
Epoch  95/150 | Train MAE: 1.8511Â° | Val MAE: 1.3040Â° (Yaw=1.5812Â°, Pitch=1.3079Â°, Roll=1.0230Â°)       
Epoch 100/150 | Train MAE: 1.8164Â° | Val MAE: 1.2596Â° (Yaw=1.5435Â°, Pitch=1.2405Â°, Roll=0.9948Â°)       
Epoch 105/150 | Train MAE: 1.8011Â° | Val MAE: 1.2755Â° (Yaw=1.6468Â°, Pitch=1.1612Â°, Roll=1.0185Â°)       
Epoch 110/150 | Train MAE: 1.7835Â° | Val MAE: 1.2110Â° (Yaw=1.4087Â°, Pitch=1.2609Â°, Roll=0.9633Â°)       
Epoch 115/150 | Train MAE: 1.7645Â° | Val MAE: 1.2541Â° (Yaw=1.4770Â°, Pitch=1.2926Â°, Roll=0.9927Â°)       
Epoch 120/150 | Train MAE: 1.7411Â° | Val MAE: 1.1088Â° (Yaw=1.2356Â°, Pitch=1.1923Â°, Roll=0.8986Â°)       
   âœ“ New best model saved (Val MAE: 1.1088Â°)
Epoch 125/150 | Train MAE: 1.7379Â° | Val MAE: 1.1434Â° (Yaw=1.2402Â°, Pitch=1.2692Â°, Roll=0.9208Â°)       
Epoch 130/150 | Train MAE: 1.7168Â° | Val MAE: 1.1864Â° (Yaw=1.3990Â°, Pitch=1.1974Â°, Roll=0.9628Â°)       
Epoch 135/150 | Train MAE: 1.7129Â° | Val MAE: 1.1304Â° (Yaw=1.2828Â°, Pitch=1.1709Â°, Roll=0.9375Â°)       
Epoch 140/150 | Train MAE: 1.7275Â° | Val MAE: 1.1359Â° (Yaw=1.3239Â°, Pitch=1.1001Â°, Roll=0.9837Â°)       
Epoch 145/150 | Train MAE: 1.6906Â° | Val MAE: 1.1623Â° (Yaw=1.3393Â°, Pitch=1.1308Â°, Roll=1.0169Â°)       
Epoch 150/150 | Train MAE: 1.6840Â° | Val MAE: 1.1417Â° (Yaw=1.3040Â°, Pitch=1.1234Â°, Roll=0.9978Â°)       

======================================================================
âœ… TRAINING COMPLETE!
======================================================================

ğŸ“Š Results:
   Best Val MAE:     1.0659Â°
   Yaw MAE:          1.1973Â°
   Pitch MAE:        1.0343Â°
   Roll MAE:         0.9659Â°
   Final Epoch:      150
   Model saved to:   models/ablation/backbone/attention_mobilenet_v3_large_best.pth
   History saved to: models/ablation/backbone/attention_mobilenet_v3_large_history.csv
   Parameters:       6,503,506

âœ… Fusion variant 'attention' training complete!
   Best validation MAE: 1.0659Â°

======================================================================
ğŸ“Š EVALUATING ATTENTION FUSION ON TEST SET
======================================================================
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=None`.
  warnings.warn(msg)
   Test samples: 3136
Testing: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 49/49 [00:11<00:00,  4.32it/s]

ğŸ“ˆ Test Results:
   Yaw MAE:   1.2119Â°
   Pitch MAE: 1.0101Â°
   Roll MAE:  0.9560Â°
   Mean MAE:  1.0593Â°

   Results saved to: results/csv_reports/backbone_mobilenet_v3_large_test_results.csv

âœ… Test evaluation complete!
   Test MAE: 1.0593Â°

======================================================================
[5/5] Training with EfficientNet-B0
======================================================================
======================================================================
ğŸ”— FUSION STRATEGY ABLATION: ATTENTION
======================================================================

ğŸ“‹ Configuration:
   Fusion Type: attention
   Backbone:    efficientnet_b0
   Face Dim:    1404
   Pose Dim:    99
   Epochs:      150
   Batch size:  64
   Output dir:  models/ablation/backbone
   Device:      cuda

ğŸ” Checking data preprocessing...
âœ… Data preprocessing already complete - skipping
   Using splits from: data/splits

ğŸ“‚ Loading data splits...
   Train samples: 11758
   Val samples:   784
   Y mean: [  8.20929   -10.902234   -1.4025756]
   Y std:  [30.444633 24.493015 11.616344]

ğŸ—ï¸  Creating model...
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=EfficientNet_B0_Weights.IMAGENET1K_V1`. You can also use `weights=EfficientNet_B0_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
   Fusion Type:  attention
   Backbone:     efficientnet_b0
   Parameters:   7,866,782
   Model size:   30.01 MB

âš™ï¸  Setting up training...

ğŸš€ Starting training...
======================================================================
Epoch   1/150 | Train MAE: 10.8257Â° | Val MAE: 5.8122Â° (Yaw=8.4529Â°, Pitch=5.0604Â°, Roll=3.9232Â°)      
Epoch   5/150 | Train MAE: 4.0338Â° | Val MAE: 2.7689Â° (Yaw=3.3556Â°, Pitch=2.6941Â°, Roll=2.2570Â°)       
Epoch  10/150 | Train MAE: 3.2591Â° | Val MAE: 2.5545Â° (Yaw=3.5472Â°, Pitch=2.4087Â°, Roll=1.7075Â°)       
Epoch  15/150 | Train MAE: 2.9254Â° | Val MAE: 1.8500Â° (Yaw=2.1033Â°, Pitch=1.8434Â°, Roll=1.6033Â°)       
Epoch  20/150 | Train MAE: 2.7426Â° | Val MAE: 1.6576Â° (Yaw=1.9222Â°, Pitch=1.6038Â°, Roll=1.4467Â°)       
   âœ“ New best model saved (Val MAE: 1.6576Â°)
Epoch  25/150 | Train MAE: 2.5901Â° | Val MAE: 1.5724Â° (Yaw=2.0119Â°, Pitch=1.4541Â°, Roll=1.2512Â°)       
Epoch  30/150 | Train MAE: 2.4543Â° | Val MAE: 1.8383Â° (Yaw=2.4852Â°, Pitch=1.6534Â°, Roll=1.3763Â°)       
Epoch  35/150 | Train MAE: 2.3709Â° | Val MAE: 1.5237Â° (Yaw=1.7385Â°, Pitch=1.5916Â°, Roll=1.2411Â°)       
Epoch  40/150 | Train MAE: 2.2510Â° | Val MAE: 1.4160Â° (Yaw=1.7391Â°, Pitch=1.3874Â°, Roll=1.1214Â°)       
Epoch  45/150 | Train MAE: 2.2034Â° | Val MAE: 1.5128Â° (Yaw=1.7530Â°, Pitch=1.5384Â°, Roll=1.2469Â°)       
Epoch  50/150 | Train MAE: 2.1300Â° | Val MAE: 1.3315Â° (Yaw=1.4731Â°, Pitch=1.4776Â°, Roll=1.0437Â°)       
Epoch  55/150 | Train MAE: 2.1043Â° | Val MAE: 1.4711Â° (Yaw=1.5273Â°, Pitch=1.6448Â°, Roll=1.2412Â°)       
Epoch  60/150 | Train MAE: 2.0361Â° | Val MAE: 1.2544Â° (Yaw=1.4492Â°, Pitch=1.2233Â°, Roll=1.0905Â°)       
Epoch  65/150 | Train MAE: 2.0303Â° | Val MAE: 1.4995Â° (Yaw=1.9690Â°, Pitch=1.2987Â°, Roll=1.2309Â°)       
Epoch  70/150 | Train MAE: 1.9381Â° | Val MAE: 1.2717Â° (Yaw=1.4929Â°, Pitch=1.2851Â°, Roll=1.0371Â°)       
Epoch  75/150 | Train MAE: 1.9456Â° | Val MAE: 1.1949Â° (Yaw=1.4073Â°, Pitch=1.1534Â°, Roll=1.0239Â°)       
Epoch  80/150 | Train MAE: 1.8926Â° | Val MAE: 1.2372Â° (Yaw=1.4251Â°, Pitch=1.2865Â°, Roll=0.9999Â°)       
Epoch  85/150 | Train MAE: 1.8891Â° | Val MAE: 1.1340Â° (Yaw=1.3169Â°, Pitch=1.0925Â°, Roll=0.9928Â°)       
Epoch  90/150 | Train MAE: 1.8432Â° | Val MAE: 1.0896Â° (Yaw=1.2114Â°, Pitch=1.1508Â°, Roll=0.9065Â°)       
   âœ“ New best model saved (Val MAE: 1.0896Â°)
Epoch  95/150 | Train MAE: 1.8509Â° | Val MAE: 1.1967Â° (Yaw=1.4629Â°, Pitch=1.1331Â°, Roll=0.9940Â°)       
Epoch 100/150 | Train MAE: 1.8290Â° | Val MAE: 1.2248Â° (Yaw=1.4786Â°, Pitch=1.1447Â°, Roll=1.0512Â°)       
Epoch 105/150 | Train MAE: 1.7976Â° | Val MAE: 1.1185Â° (Yaw=1.3244Â°, Pitch=1.1172Â°, Roll=0.9139Â°)       
Epoch 110/150 | Train MAE: 1.7911Â° | Val MAE: 1.0992Â° (Yaw=1.2450Â°, Pitch=1.0742Â°, Roll=0.9783Â°)       
Epoch 115/150 | Train MAE: 1.7533Â° | Val MAE: 1.1267Â° (Yaw=1.3469Â°, Pitch=1.0848Â°, Roll=0.9483Â°)       
Epoch 120/150 | Train MAE: 1.7491Â° | Val MAE: 1.0940Â° (Yaw=1.2927Â°, Pitch=1.0342Â°, Roll=0.9549Â°)       
Epoch 125/150 | Train MAE: 1.7282Â° | Val MAE: 1.1194Â° (Yaw=1.3927Â°, Pitch=1.0592Â°, Roll=0.9065Â°)       
Epoch 130/150 | Train MAE: 1.7246Â° | Val MAE: 1.0788Â° (Yaw=1.3250Â°, Pitch=0.9749Â°, Roll=0.9365Â°)       
Epoch 135/150 | Train MAE: 1.7046Â° | Val MAE: 1.1880Â° (Yaw=1.4034Â°, Pitch=1.2293Â°, Roll=0.9313Â°)       
Epoch 140/150 | Train MAE: 1.6853Â° | Val MAE: 1.1039Â° (Yaw=1.3802Â°, Pitch=1.0216Â°, Roll=0.9098Â°)       
                                                                                                       
Early stopping triggered after 144 epochs (no improvement for 20 epochs)

======================================================================
âœ… TRAINING COMPLETE!
======================================================================

ğŸ“Š Results:
   Best Val MAE:     1.0232Â°
   Yaw MAE:          1.2070Â°
   Pitch MAE:        0.9637Â°
   Roll MAE:         0.8987Â°
   Final Epoch:      144
   Model saved to:   models/ablation/backbone/attention_efficientnet_b0_best.pth
   History saved to: models/ablation/backbone/attention_efficientnet_b0_history.csv
   Parameters:       7,866,782

âœ… Fusion variant 'attention' training complete!
   Best validation MAE: 1.0232Â°

======================================================================
ğŸ“Š EVALUATING ATTENTION FUSION ON TEST SET
======================================================================
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=None`.
  warnings.warn(msg)
   Test samples: 3136
Testing: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 49/49 [00:11<00:00,  4.24it/s]

ğŸ“ˆ Test Results:
   Yaw MAE:   1.1896Â°
   Pitch MAE: 0.9993Â°
   Roll MAE:  0.9501Â°
   Mean MAE:  1.0463Â°

   Results saved to: results/csv_reports/backbone_efficientnet_b0_test_results.csv

âœ… Test evaluation complete!
   Test MAE: 1.0463Â°

======================================================================
âœ… ALL BACKBONE ABLATION EXPERIMENTS COMPLETE!
======================================================================

Results saved to:
  results/csv_reports/backbone_resnet34_test_results.csv
  results/csv_reports/backbone_resnet18_test_results.csv
  results/csv_reports/backbone_resnet50_test_results.csv
  results/csv_reports/backbone_mobilenet_v3_large_test_results.csv
  results/csv_reports/backbone_efficientnet_b0_test_results.csv

Models saved to: models/ablation/backbone/
(venv) âœ  Archive git:(main) âœ— 








(venv) âœ  Archive git:(main) âœ— python train_fusion_ablation.py \
    --fusion_type attention \
    --backbone efficientnet_b0 \
    --face_dim 1404 \
    --pose_dim 99 \
    --epochs 150 \
    --batch_size 64
======================================================================
ğŸ”— FUSION STRATEGY ABLATION: ATTENTION
======================================================================

ğŸ“‹ Configuration:
   Fusion Type: attention
   Backbone:    efficientnet_b0
   Face Dim:    1404
   Pose Dim:    99
   Epochs:      150
   Batch size:  64
   Output dir:  models/ablation/fusion
   Device:      cuda

ğŸ” Checking data preprocessing...
âœ… Data preprocessing already complete - skipping
   Using splits from: data/splits

ğŸ“‚ Loading data splits...
   Train samples: 11758
   Val samples:   784
   Y mean: [  8.20929   -10.902234   -1.4025756]
   Y std:  [30.444633 24.493015 11.616344]

ğŸ—ï¸  Creating model...
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=EfficientNet_B0_Weights.IMAGENET1K_V1`. You can also use `weights=EfficientNet_B0_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
   Fusion Type:  attention
   Backbone:     efficientnet_b0
   Parameters:   7,866,782
   Model size:   30.01 MB

âš™ï¸  Setting up training...

ğŸš€ Starting training...
======================================================================
Epoch   1/150 | Train MAE: 10.8831Â° | Val MAE: 5.6214Â° (Yaw=7.3135Â°, Pitch=5.5640Â°, Roll=3.9868Â°)      
Epoch   5/150 | Train MAE: 3.9514Â° | Val MAE: 2.5504Â° (Yaw=3.2091Â°, Pitch=2.3934Â°, Roll=2.0487Â°)       
Epoch  10/150 | Train MAE: 3.2758Â° | Val MAE: 2.1740Â° (Yaw=2.6247Â°, Pitch=1.9859Â°, Roll=1.9113Â°)       
Epoch  15/150 | Train MAE: 2.9268Â° | Val MAE: 1.8624Â° (Yaw=2.4140Â°, Pitch=1.7077Â°, Roll=1.4655Â°)       
Epoch  20/150 | Train MAE: 2.7393Â° | Val MAE: 1.7142Â° (Yaw=2.0930Â°, Pitch=1.6668Â°, Roll=1.3828Â°)       
Epoch  25/150 | Train MAE: 2.5627Â° | Val MAE: 1.8367Â° (Yaw=2.3967Â°, Pitch=1.7468Â°, Roll=1.3666Â°)       
Epoch  30/150 | Train MAE: 2.4137Â° | Val MAE: 1.5703Â° (Yaw=1.9336Â°, Pitch=1.4714Â°, Roll=1.3057Â°)       
Epoch  35/150 | Train MAE: 2.3229Â° | Val MAE: 1.4565Â° (Yaw=1.7636Â°, Pitch=1.4565Â°, Roll=1.1494Â°)       
Epoch  40/150 | Train MAE: 2.2622Â° | Val MAE: 1.4371Â° (Yaw=1.6628Â°, Pitch=1.5030Â°, Roll=1.1456Â°)       
Epoch  45/150 | Train MAE: 2.1731Â° | Val MAE: 1.3677Â° (Yaw=1.6333Â°, Pitch=1.3904Â°, Roll=1.0793Â°)       
Epoch  50/150 | Train MAE: 2.1534Â° | Val MAE: 1.2930Â° (Yaw=1.5407Â°, Pitch=1.3164Â°, Roll=1.0218Â°)       
   âœ“ New best model saved (Val MAE: 1.2930Â°)
Epoch  55/150 | Train MAE: 2.0955Â° | Val MAE: 1.2589Â° (Yaw=1.5059Â°, Pitch=1.3157Â°, Roll=0.9550Â°)       
Epoch  60/150 | Train MAE: 2.0418Â° | Val MAE: 1.3880Â° (Yaw=1.7289Â°, Pitch=1.3702Â°, Roll=1.0649Â°)       
Epoch  65/150 | Train MAE: 2.0040Â° | Val MAE: 1.3368Â° (Yaw=1.5797Â°, Pitch=1.3415Â°, Roll=1.0893Â°)       
Epoch  70/150 | Train MAE: 1.9496Â° | Val MAE: 1.1838Â° (Yaw=1.3189Â°, Pitch=1.2396Â°, Roll=0.9930Â°)       
   âœ“ New best model saved (Val MAE: 1.1838Â°)
Epoch  75/150 | Train MAE: 1.9368Â° | Val MAE: 1.2823Â° (Yaw=1.5969Â°, Pitch=1.2654Â°, Roll=0.9846Â°)       
Epoch  80/150 | Train MAE: 1.9185Â° | Val MAE: 1.2387Â° (Yaw=1.3919Â°, Pitch=1.2787Â°, Roll=1.0455Â°)       
Epoch  85/150 | Train MAE: 1.8667Â° | Val MAE: 1.2623Â° (Yaw=1.5718Â°, Pitch=1.2307Â°, Roll=0.9846Â°)       
Epoch  90/150 | Train MAE: 1.8871Â° | Val MAE: 1.1380Â° (Yaw=1.3073Â°, Pitch=1.1576Â°, Roll=0.9491Â°)       
   âœ“ New best model saved (Val MAE: 1.1380Â°)
Epoch  95/150 | Train MAE: 1.8303Â° | Val MAE: 1.2406Â° (Yaw=1.2742Â°, Pitch=1.4522Â°, Roll=0.9952Â°)       
Epoch 100/150 | Train MAE: 1.8017Â° | Val MAE: 1.0830Â° (Yaw=1.1775Â°, Pitch=1.1589Â°, Roll=0.9126Â°)       
   âœ“ New best model saved (Val MAE: 1.0830Â°)
Epoch 105/150 | Train MAE: 1.8013Â° | Val MAE: 1.2541Â° (Yaw=1.4995Â°, Pitch=1.2885Â°, Roll=0.9742Â°)       
Epoch 110/150 | Train MAE: 1.7611Â° | Val MAE: 1.0891Â° (Yaw=1.2984Â°, Pitch=1.0569Â°, Roll=0.9120Â°)       
Epoch 115/150 | Train MAE: 1.7871Â° | Val MAE: 1.1473Â° (Yaw=1.3180Â°, Pitch=1.1991Â°, Roll=0.9247Â°)       
Epoch 120/150 | Train MAE: 1.7349Â° | Val MAE: 1.0516Â° (Yaw=1.1945Â°, Pitch=1.0340Â°, Roll=0.9263Â°)       
   âœ“ New best model saved (Val MAE: 1.0516Â°)
Epoch 125/150 | Train MAE: 1.7402Â° | Val MAE: 1.2194Â° (Yaw=1.5875Â°, Pitch=1.1084Â°, Roll=0.9623Â°)       
Epoch 130/150 | Train MAE: 1.7286Â° | Val MAE: 1.0315Â° (Yaw=1.2270Â°, Pitch=0.9881Â°, Roll=0.8794Â°)       
   âœ“ New best model saved (Val MAE: 1.0315Â°)
Epoch 135/150 | Train MAE: 1.7166Â° | Val MAE: 1.1843Â° (Yaw=1.4178Â°, Pitch=1.2172Â°, Roll=0.9179Â°)       
Epoch 140/150 | Train MAE: 1.7013Â° | Val MAE: 1.2120Â° (Yaw=1.4521Â°, Pitch=1.1885Â°, Roll=0.9953Â°)       
Epoch 145/150 | Train MAE: 1.6652Â° | Val MAE: 1.0634Â° (Yaw=1.2534Â°, Pitch=1.0718Â°, Roll=0.8650Â°)       
Epoch 150/150 | Train MAE: 1.6847Â° | Val MAE: 1.0621Â° (Yaw=1.3351Â°, Pitch=0.9841Â°, Roll=0.8671Â°)       

Early stopping triggered after 150 epochs (no improvement for 20 epochs)

======================================================================
âœ… TRAINING COMPLETE!
======================================================================

ğŸ“Š Results:
   Best Val MAE:     1.0315Â°
   Yaw MAE:          1.2270Â°
   Pitch MAE:        0.9881Â°
   Roll MAE:         0.8794Â°
   Final Epoch:      150
   Model saved to:   models/ablation/fusion/fusion_attention_efficientnet_b0_best.pth
   History saved to: models/ablation/fusion/fusion_attention_efficientnet_b0_history.csv
   Parameters:       7,866,782

âœ… Fusion variant 'attention' training complete!
   Best validation MAE: 1.0315Â°

======================================================================
ğŸ“Š EVALUATING ATTENTION FUSION ON TEST SET
======================================================================
/home/genesys/hamza/cervical/Archive/venv/lib/python3.12/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=None`.
  warnings.warn(msg)
   Test samples: 3136
Testing: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 49/49 [00:11<00:00,  4.21it/s]

ğŸ“ˆ Test Results:
   Yaw MAE:   1.1464Â°
   Pitch MAE: 0.9496Â°
   Roll MAE:  0.9547Â°
   Mean MAE:  1.0169Â°

   Results saved to: results/csv_reports/fusion_attention_test_results.csv

âœ… Test evaluation complete!
   Test MAE: 1.0169Â°